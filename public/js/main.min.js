"use strict";var restaurants,neighborhoods,cuisines,newMap,db,markers=[],fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e||(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e||(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},initMap=function(){self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYnJhZHl0Zm9yZCIsImEiOiJjamlydTVnZngwMXlhM3dxbTE2NzNhbWNjIn0.vP54TruwPoPWQLYZdPKcug",maxZoom:18,id:"mapbox.streets"}).addTo(newMap),updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,a=t.selectedIndex,r=e[n].value,o=t[a].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,o,function(e,t){e||(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers&&self.markers.forEach(function(e){return e.remove()}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("article");t.setAttribute("id","restaurant-".concat(e.id));var n=document.createElement("img");n.className="restaurant-img",n.src=DBHelper.imageUrlForRestaurant(e),n.alt=DBHelper.imageAltforRestaurant(e),t.append(n);var a=document.createElement("header"),r=document.createElement("h2"),o=document.createElement("span"),s=!1===e.is_favorite||"false"===e.is_favorite?"star":"star favorite";o.setAttribute("onclick","toggleFavorite('restaurant-".concat(e.id,"')")),o.setAttribute("class",s),r.innerHTML=e.name,r.append(o),a.appendChild(r),t.append(a);var i=document.createElement("p");i.innerHTML=e.neighborhood,t.append(i);var l=document.createElement("p");l.innerHTML=e.address,t.append(l);var c=document.createElement("a");return c.innerHTML="View Details",c.href=DBHelper.urlForRestaurant(e),c.setAttribute("role","button"),t.append(c),t},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.newMap);function n(){window.location.href=t.options.url}t.on("click",n),t.on("keydown",function(e){alert(),event.preventDefault(),13===e.keyCode&&n()}),self.markers.push(t)}),document.querySelectorAll("img.leaflet-marker-icon").forEach(function(e){e.setAttribute("role","link")})},toggleFavorite=function(e){var t=document.querySelector("#".concat(e," .star"));-1<t.className.indexOf("favorite")?(t.className="star",DBHelper.sendToggleFav(e.slice(-1),!1)):(t.className="star favorite",DBHelper.sendToggleFav(e.slice(-1),!0))};document.addEventListener("DOMContentLoaded",function(e){initMap(),fetchNeighborhoods(),fetchCuisines()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJuZXdNYXAiLCJkYiIsIm1hcmtlcnMiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJEQkhlbHBlciIsImVycm9yIiwic2VsZiIsImZpbGxOZWlnaGJvcmhvb2RzSFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInNlbGVjdCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JFYWNoIiwibmVpZ2hib3Job29kIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInZhbHVlIiwiYXBwZW5kIiwiZmV0Y2hDdWlzaW5lcyIsImZpbGxDdWlzaW5lc0hUTUwiLCJjdWlzaW5lIiwiaW5pdE1hcCIsIkwiLCJtYXAiLCJjZW50ZXIiLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiaWQiLCJhZGRUbyIsInVwZGF0ZVJlc3RhdXJhbnRzIiwiY1NlbGVjdCIsIm5TZWxlY3QiLCJjSW5kZXgiLCJzZWxlY3RlZEluZGV4IiwibkluZGV4IiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJtYXJrZXIiLCJyZW1vdmUiLCJ1bCIsInJlc3RhdXJhbnQiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImFkZE1hcmtlcnNUb01hcCIsImFydCIsInNldEF0dHJpYnV0ZSIsImNvbmNhdCIsImltYWdlIiwiY2xhc3NOYW1lIiwic3JjIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwiYWx0IiwiaW1hZ2VBbHRmb3JSZXN0YXVyYW50IiwiaGVhZGVyIiwibmFtZSIsInN0YXIiLCJjbGFzc1N0cmluZyIsImlzX2Zhdm9yaXRlIiwiYXBwZW5kQ2hpbGQiLCJhZGRyZXNzIiwibW9yZSIsImhyZWYiLCJ1cmxGb3JSZXN0YXVyYW50IiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsIm9uQ2xpY2siLCJ3aW5kb3ciLCJsb2NhdGlvbiIsIm9wdGlvbnMiLCJ1cmwiLCJvbiIsImUiLCJhbGVydCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJrZXlDb2RlIiwicHVzaCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbGVtIiwidG9nZ2xlRmF2b3JpdGUiLCJ0aGlzU3RhciIsInF1ZXJ5U2VsZWN0b3IiLCJpbmRleE9mIiwic2VuZFRvZ2dsZUZhdiIsInNsaWNlIiwiYWRkRXZlbnRMaXN0ZW5lciJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBSUEsWUFDRkMsY0FDQUMsU0FDQUMsT0FFQUMsR0FEQUMsUUFBVSxHQU1SQyxtQkFBcUIsV0FDdkJDLFNBQVNELG1CQUFtQixTQUFDRSxFQUFPUCxHQUM5Qk8sSUFJRkMsS0FBS1IsY0FBZ0JBLEVBQ3JCUyw0QkFRRkEsc0JBQXdCLFdBQXdDLElBQXZDVCxFQUF1QyxFQUFBVSxVQUFBQyxhQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBdkJGLEtBQUtSLGNBQzFDYSxFQUFTQyxTQUFTQyxlQUFlLHdCQUN2Q2YsRUFBY2dCLFFBQVEsU0FBQUMsR0FDcEIsSUFBTUMsRUFBU0osU0FBU0ssY0FBYyxVQUN0Q0QsRUFBT0UsVUFBWUgsRUFDbkJDLEVBQU9HLE1BQVFKLEVBQ2ZKLEVBQU9TLE9BQU9KLE1BT2RLLGNBQWdCLFdBQ2xCakIsU0FBU2lCLGNBQWMsU0FBQ2hCLEVBQU9OLEdBQ3pCTSxJQUlGQyxLQUFLUCxTQUFXQSxFQUNoQnVCLHVCQVFGQSxpQkFBbUIsV0FBOEIsSUFBN0J2QixFQUE2QixFQUFBUyxVQUFBQyxhQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBbEJGLEtBQUtQLFNBQ2hDWSxFQUFTQyxTQUFTQyxlQUFlLG1CQUV2Q2QsRUFBU2UsUUFBUSxTQUFBUyxHQUNmLElBQU1QLEVBQVNKLFNBQVNLLGNBQWMsVUFDdENELEVBQU9FLFVBQVlL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QUFTTCxLQUFPdkIsRUFBTzZCLFFBQVFDLElBRnhDOUIsRUFBTytCLEdBQUcsUUFBU0wsR0FJbkIxQixFQUFPK0IsR0FBRyxVQUFXLFNBQUFDLEdBQ25CQyxRQUNBQyxNQUFNQyxpQkFDWSxLQUFkSCxFQUFFSSxTQUFnQlYsTUFFeEJoRSxLQUFLSixRQUFRK0UsS0FBS3JDLEtBRXBCaEMsU0FBU3NFLGlCQUFpQiwyQkFBMkJwRSxRQUFRLFNBQUFxRSxHQUMzREEsRUFBS2hDLGFBQWEsT0FBUSxXQUkxQmlDLGVBQWlCLFNBQUNuRCxHQUNwQixJQUFJb0QsRUFBV3pFLFNBQVMwRSxjQUFULElBQUFsQyxPQUEyQm5CLEVBQTNCLFlBRStCLEVBQTFDb0QsRUFBUy9CLFVBQVVpQyxRQUFRLGFBQzdCRixFQUFTL0IsVUFBWSxPQUNyQmxELFNBQVNvRixjQUFjdkQsRUFBR3dELE9BQU8sSUFBSSxLQUVyQ0osRUFBUy9CLFVBQVksZ0JBQ3JCbEQsU0FBU29GLGNBQWN2RCxFQUFHd0QsT0FBTyxJQUFJLEtBUXpDN0UsU0FBUzhFLGlCQUFpQixtQkFBb0IsU0FBQVosR0FDNUN0RCxVQUNBckIscUJBQ0FrQiIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50cyxcclxuICBuZWlnaGJvcmhvb2RzLFxyXG4gIGN1aXNpbmVzLFxyXG4gIG5ld01hcCxcclxuICBtYXJrZXJzID0gW10sXHJcbiAgZGJcclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5sZXQgZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoTmVpZ2hib3Job29kcygoZXJyb3IsIG5laWdoYm9yaG9vZHMpID0+IHtcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICAvLyBHb3QgYW4gZXJyb3JcclxuICAgICAgLy8gY29uc29sZS5lcnJvcihlcnJvcilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYubmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHNcclxuICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKClcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogU2V0IG5laWdoYm9yaG9vZHMgSFRNTC5cclxuICovXHJcbmxldCBmaWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpXHJcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKVxyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZFxyXG4gICAgb3B0aW9uLnZhbHVlID0gbmVpZ2hib3Job29kXHJcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbilcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIGN1aXNpbmVzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmxldCBmZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgLy8gY29uc29sZS5lcnJvcihlcnJvcilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lc1xyXG4gICAgICBmaWxsQ3Vpc2luZXNIVE1MKClcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogU2V0IGN1aXNpbmVzIEhUTUwuXHJcbiAqL1xyXG5sZXQgZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0JylcclxuXHJcbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpXHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gY3Vpc2luZVxyXG4gICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZVxyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pXHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXHJcbiAqL1xyXG5sZXQgaW5pdE1hcCA9ICgpID0+IHtcclxuICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XHJcbiAgICBjZW50ZXI6IFs0MC43MjIyMTYsIC03My45ODc1MDFdLFxyXG4gICAgem9vbTogMTIsXHJcbiAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXHJcbiAgfSlcclxuICBMLnRpbGVMYXllcihcclxuICAgICdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLFxyXG4gICAge1xyXG4gICAgICBtYXBib3hUb2tlbjpcclxuICAgICAgICAncGsuZXlKMUlqb2lZbkpoWkhsMFptOXlaQ0lzSW1FaU9pSmphbWx5ZFRWblpuZ3dNWGxoTTNkeGJURTJOek5oYldOakluMC52UDU0VHJ1d1BvUFdRTFlaZFBLY3VnJyxcclxuICAgICAgbWF4Wm9vbTogMTgsXHJcbiAgICAgIGlkOiAnbWFwYm94LnN0cmVldHMnXHJcbiAgICB9XHJcbiAgKS5hZGRUbyhuZXdNYXApXHJcblxyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKClcclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXHJcbiAqL1xyXG5sZXQgdXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKVxyXG4gIGNvbnN0IG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKVxyXG5cclxuICBjb25zdCBjSW5kZXggPSBjU2VsZWN0LnNlbGVjdGVkSW5kZXhcclxuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXhcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZVxyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IG5TZWxlY3RbbkluZGV4XS52YWx1ZVxyXG5cclxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoXHJcbiAgICBjdWlzaW5lLFxyXG4gICAgbmVpZ2hib3Job29kLFxyXG4gICAgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgICAgLy8gY29uc29sZS5lcnJvcihlcnJvcilcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKVxyXG4gICAgICAgIGZpbGxSZXN0YXVyYW50c0hUTUwoKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKVxyXG59XHJcblxyXG4vKipcclxuICogQ2xlYXIgY3VycmVudCByZXN0YXVyYW50cywgdGhlaXIgSFRNTCBhbmQgcmVtb3ZlIHRoZWlyIG1hcCBtYXJrZXJzLlxyXG4gKi9cclxubGV0IHJlc2V0UmVzdGF1cmFudHMgPSByZXN0YXVyYW50cyA9PiB7XHJcbiAgLy8gUmVtb3ZlIGFsbCByZXN0YXVyYW50c1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXVxyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKVxyXG4gIHVsLmlubmVySFRNTCA9ICcnXHJcblxyXG4gIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcclxuICBpZiAoc2VsZi5tYXJrZXJzKSB7XHJcbiAgICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtYXJrZXIgPT4gbWFya2VyLnJlbW92ZSgpKVxyXG4gIH1cclxuICBzZWxmLm1hcmtlcnMgPSBbXVxyXG4gIHNlbGYucmVzdGF1cmFudHMgPSByZXN0YXVyYW50c1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUganBnYWdlLlxyXG4gKi9cclxubGV0IGZpbGxSZXN0YXVyYW50c0hUTUwgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpXHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSlcclxuICB9KVxyXG4gIGFkZE1hcmtlcnNUb01hcCgpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MLlxyXG4gKi9cclxubGV0IGNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gcmVzdGF1cmFudCA9PiB7XHJcbiAgY29uc3QgYXJ0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXJ0aWNsZScpXHJcbiAgYXJ0LnNldEF0dHJpYnV0ZSgnaWQnLCBgcmVzdGF1cmFudC0ke3Jlc3RhdXJhbnQuaWR9YClcclxuXHJcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKVxyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZydcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudClcclxuICBpbWFnZS5hbHQgPSBEQkhlbHBlci5pbWFnZUFsdGZvclJlc3RhdXJhbnQocmVzdGF1cmFudClcclxuICBhcnQuYXBwZW5kKGltYWdlKVxyXG5cclxuICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoZWFkZXInKVxyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpXHJcbiAgY29uc3Qgc3RhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxyXG4gIGNvbnN0IGNsYXNzU3RyaW5nID0gcmVzdGF1cmFudC5pc19mYXZvcml0ZSA9PT0gZmFsc2UgfHwgcmVzdGF1cmFudC5pc19mYXZvcml0ZSA9PT0gJ2ZhbHNlJyAgPyAnc3RhcicgOiAnc3RhciBmYXZvcml0ZSdcclxuICBcclxuICBzdGFyLnNldEF0dHJpYnV0ZSgnb25jbGljaycsIGB0b2dnbGVGYXZvcml0ZShcXCdyZXN0YXVyYW50LSR7cmVzdGF1cmFudC5pZH1cXCcpYClcclxuICBzdGFyLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBjbGFzc1N0cmluZylcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZVxyXG4gIG5hbWUuYXBwZW5kKHN0YXIpXHJcbiAgaGVhZGVyLmFwcGVuZENoaWxkKG5hbWUpXHJcbiAgYXJ0LmFwcGVuZChoZWFkZXIpXHJcblxyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxyXG4gIG5laWdoYm9yaG9vZC5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5laWdoYm9yaG9vZFxyXG4gIGFydC5hcHBlbmQobmVpZ2hib3Job29kKVxyXG5cclxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3NcclxuICBhcnQuYXBwZW5kKGFkZHJlc3MpXHJcblxyXG4gIGNvbnN0IG1vcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJylcclxuICBtb3JlLmlubmVySFRNTCA9ICdWaWV3IERldGFpbHMnXHJcbiAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KVxyXG4gIG1vcmUuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2J1dHRvbicpXHJcblxyXG4gIGFydC5hcHBlbmQobW9yZSlcclxuXHJcbiAgcmV0dXJuIGFydFxyXG59XHJcblxyXG4vKipcclxuICogQWRkIG1hcmtlcnMgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMgdG8gdGhlIG1hcC5cclxuICovXHJcbmxldCBhZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm5ld01hcClcclxuICAgIG1hcmtlci5vbignY2xpY2snLCBvbkNsaWNrKVxyXG4gICAgZnVuY3Rpb24gb25DbGljaygpIHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIub3B0aW9ucy51cmxcclxuICAgIH1cclxuICAgIG1hcmtlci5vbigna2V5ZG93bicsIGUgPT4ge1xyXG4gICAgICBhbGVydCgpXHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcclxuICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIG9uQ2xpY2soKVxyXG4gICAgfSlcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcilcclxuICB9KVxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZy5sZWFmbGV0LW1hcmtlci1pY29uJykuZm9yRWFjaChlbGVtID0+IHtcclxuICAgIGVsZW0uc2V0QXR0cmlidXRlKCdyb2xlJywgJ2xpbmsnKVxyXG4gIH0pXHJcbn1cclxuXHJcbmxldCB0b2dnbGVGYXZvcml0ZSA9IChpZCkgPT4ge1xyXG4gIGxldCB0aGlzU3RhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lkfSAuc3RhcmApXHJcbiAgXHJcbiAgaWYgKHRoaXNTdGFyLmNsYXNzTmFtZS5pbmRleE9mKCdmYXZvcml0ZScpID4gLTEpIHtcclxuICAgIHRoaXNTdGFyLmNsYXNzTmFtZSA9ICdzdGFyJ1xyXG4gICAgREJIZWxwZXIuc2VuZFRvZ2dsZUZhdihpZC5zbGljZSgtMSksIGZhbHNlKVxyXG4gIH0gZWxzZSB7ICAgIFxyXG4gICAgdGhpc1N0YXIuY2xhc3NOYW1lID0gJ3N0YXIgZmF2b3JpdGUnXHJcbiAgICBEQkhlbHBlci5zZW5kVG9nZ2xlRmF2KGlkLnNsaWNlKC0xKSwgdHJ1ZSlcclxuICB9XHJcblxyXG59XHJcblxyXG4vKipcclxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZXZlbnQgPT4ge1xyXG4gIGluaXRNYXAoKSAvLyBhZGRlZFxyXG4gIGZldGNoTmVpZ2hib3Job29kcygpXHJcbiAgZmV0Y2hDdWlzaW5lcygpXHJcbn0pIl19
