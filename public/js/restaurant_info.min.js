"use strict";var restaurant,newMap;document.addEventListener("DOMContentLoaded",function(e){initMap()});var initMap=function(){fetchRestaurantFromURL(function(e,t){e||(document.title="Restaurant Reviews - ".concat(t.name),self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYnJhZHl0Zm9yZCIsImEiOiJjamlydTVnZngwMXlhM3dxbTE2NzNhbWNjIn0.vP54TruwPoPWQLYZdPKcug",maxZoom:18,id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap)),document.querySelector("img.leaflet-marker-icon").setAttribute("aria-label","")})},fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,function(e,n){(self.restaurant=n)&&DBHelper.fetchReviewsByRestaurantId(t,function(e,t){self.restaurant.reviews=t,fillRestaurantHTML(),r(null,n)})}):(error="No restaurant id in URL",r(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("restaurant-name"),n=document.createElement("span"),r=!0===e.is_favorite?"star favorite":"star";n.setAttribute("onclick","toggleFavorite()"),n.setAttribute("class",r),t.innerHTML=e.name,t.append(n),document.getElementById("restaurant-address").innerHTML=e.address;var a=document.getElementById("restaurant-img");a.className="restaurant-img",a.alt=DBHelper.imageAltforRestaurant(e),a.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=n,r.appendChild(a);var i=document.createElement("td");i.innerHTML=e[n],r.appendChild(i),t.appendChild(r)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("div");n.setAttribute("id","titleBox");var r=document.createElement("h2");if(r.innerHTML="Reviews",n.append(r),t.prepend(n),!e){var a=document.createElement("p");return a.innerHTML="No reviews yet!",void n.appendChild(a)}for(var i=document.getElementById("reviews-list");i.firstChild;)i.removeChild(i.firstChild);e.forEach(function(e){i.appendChild(createReviewHTML(e))}),i.appendChild(createForm()),t.appendChild(i)},createReviewHTML=function(e){var t=document.createElement("article");t.setAttribute("tabindex",0);var n=document.createElement("h3");n.innerHTML=e.name,t.appendChild(n);var r=document.createElement("p");r.innerHTML=new Date(e.updatedAt).toLocaleString(),t.appendChild(r);var a=document.createElement("p");a.innerHTML="Rating: ".concat(e.rating),t.appendChild(a);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},createForm=function(){var e=document.createElement("article"),t=document.createElement("h3");t.innerHTML="Missing your favorite spot?",e.append(t);var n=document.createElement("h4");n.innerHTML="Add a restaurant to our listings below.",e.append(n);var r=document.createElement("form");r.setAttribute("action","javascript:void(0)"),r.setAttribute("onsubmit","submitReview()");var a=document.createElement("div"),i=document.createElement("label");i.innerHTML="Your Name",i.setAttribute("for","reviewerName"),a.append(i);var u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("name","reviewerName"),u.setAttribute("id","reviewerName"),u.setAttribute("required","required"),a.append(u),r.append(a);var l=document.createElement("div"),d=document.createElement("label");d.innerHTML="Rating (1-5)",d.setAttribute("for","newReviewRating"),l.append(d);var s=document.createElement("input");s.setAttribute("type","number"),s.setAttribute("min","1"),s.setAttribute("max","5"),s.setAttribute("name","newReviewRating"),s.setAttribute("id","newReviewRating"),s.setAttribute("required","required"),l.append(s),r.append(l);var m=document.createElement("div"),o=document.createElement("label");o.innerHTML="Comments",o.setAttribute("for","newReviewComments"),m.append(o);var c=document.createElement("textarea");c.setAttribute("name","newReviewComments"),c.setAttribute("id","newReviewComments"),c.setAttribute("rows","5"),c.setAttribute("required","required"),m.append(c),r.append(m);var p=document.createElement("button");return p.setAttribute("type","submit"),p.innerHTML="Submit",r.append(p),e.append(r),e},toggleFavorite=function(){var e=document.querySelector(".star");-1!==e.className.indexOf("favorite")?(e.className="star",DBHelper.sendToggleFav(self.restaurant.id,"false")):(e.className="star favorite",DBHelper.sendToggleFav(self.restaurant.id,"true"))},submitReview=function(){var e={id:self.restaurant.reviews.length+1,restaurant_id:self.restaurant.id,name:document.getElementById("reviewerName").value,createdAt:new Date,rating:parseInt(document.getElementById("newReviewRating").value),comments:document.getElementById("newReviewComments").value};DBHelper.addReviews(e),self.restaurant.reviews.push(e),fillReviewsHTML()};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpbml0TWFwIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImVycm9yIiwidGl0bGUiLCJjb25jYXQiLCJuYW1lIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiaWQiLCJhZGRUbyIsImZpbGxCcmVhZGNydW1iIiwiREJIZWxwZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwicXVlcnlTZWxlY3RvciIsInNldEF0dHJpYnV0ZSIsImNhbGxiYWNrIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkIiwicmV2aWV3cyIsImZpbGxSZXN0YXVyYW50SFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImdldEVsZW1lbnRCeUlkIiwic3RhciIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc1N0cmluZyIsImlzX2Zhdm9yaXRlIiwiaW5uZXJIVE1MIiwiYXBwZW5kIiwiYWRkcmVzcyIsImltYWdlIiwiY2xhc3NOYW1lIiwiYWx0IiwiaW1hZ2VBbHRmb3JSZXN0YXVyYW50Iiwic3JjIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwiY3Vpc2luZV90eXBlIiwib3BlcmF0aW5nX2hvdXJzIiwiZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJmaWxsUmV2aWV3c0hUTUwiLCJvcGVyYXRpbmdIb3VycyIsImhvdXJzIiwia2V5Iiwicm93IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwiY29udGFpbmVyIiwidGl0bGVCb3giLCJwcmVwZW5kIiwibm9SZXZpZXdzIiwidWwiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJmb3JFYWNoIiwicmV2aWV3IiwiY3JlYXRlUmV2aWV3SFRNTCIsImNyZWF0ZUZvcm0iLCJsaSIsImRhdGUiLCJEYXRlIiwidXBkYXRlZEF0IiwidG9Mb2NhbGVTdHJpbmciLCJyYXRpbmciLCJjb21tZW50cyIsImJyZWFkY3J1bWIiLCJ1cmwiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJyZXBsYWNlIiwicmVzdWx0cyIsIlJlZ0V4cCIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiLCJhcnRpY2xlIiwiaGVhZGluZyIsInN1YmhlYWRpbmciLCJmb3JtIiwiZGl2MSIsImxhYmVsMSIsImlucHV0MSIsImRpdjIiLCJsYWJlbDIiLCJpbnB1dDIiLCJkaXYzIiwibGFiZWwzIiwiaW5wdXQzIiwiYnV0dG9uIiwidG9nZ2xlRmF2b3JpdGUiLCJ0aGlzU3RhciIsImluZGV4T2YiLCJzZW5kVG9nZ2xlRmF2Iiwic3VibWl0UmV2aWV3IiwicGFyYW1zIiwicmVzdGF1cmFudF9pZCIsInZhbHVlIiwiY3JlYXRlZEF0IiwicGFyc2VJbnQiLCJhZGRSZXZpZXdzIiwicHVzaCJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBSUEsV0FDQUMsT0FLSkMsU0FBU0MsaUJBQWlCLG1CQUFvQixTQUFBQyxHQUM1Q0MsWUFNRixJQUFJQSxRQUFVLFdBQ1pDLHVCQUF1QixTQUFDQyxFQUFPUCxHQUN6Qk8sSUFJRkwsU0FBU00sTUFBVCx3QkFBQUMsT0FBeUNULEVBQVdVLE1BRXBEQyxLQUFLVixPQUFTVyxFQUFFQyxJQUFJLE1BQU8sQ0FDekJDLE9BQVEsQ0FBQ2QsRUFBV2UsT0FBT0MsSUFBS2hCLEVBQVdlLE9BQU9FLEtBQ2xEQyxLQUFNLEdBQ05DLGlCQUFpQixJQUVuQlAsRUFBRVEsVUFDQSxvRkFDQSxDQUNFQyxZQUNFLGdHQUNGQyxRQUFTLEdBQ1RDLEdBQUksbUJBRU5DLE1BQU12QixRQUNSd0IsaUJBQ0FDLFNBQVNDLHVCQUF1QmhCLEtBQUtYLFdBQVlXLEtB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RCxHQUVaLElBQU1DLEVBQVN0RyxTQUFTdUMsY0FBYyxZQUN0QytELEVBQU8zRSxhQUFhLE9BQVEscUJBQzVCMkUsRUFBTzNFLGFBQWEsS0FBTSxxQkFDMUIyRSxFQUFPM0UsYUFBYSxPQUFRLEtBQzVCMkUsRUFBTzNFLGFBQWEsV0FBWSxZQUNoQ3lFLEVBQUt6RCxPQUFPMkQsR0FFWlQsRUFBS2xELE9BQU95RCxHQUdaLElBQU1HLEVBQVN2RyxTQUFTdUMsY0FBYyxVQVF0QyxPQVBBZ0UsRUFBTzVFLGFBQWEsT0FBUSxVQUM1QjRFLEVBQU83RCxVQUFZLFNBRW5CbUQsRUFBS2xELE9BQU80RCxHQUVaYixFQUFRL0MsT0FBT2tELEdBRVJILEdBR0xjLGVBQWlCLFdBQ25CLElBQUlDLEVBQVd6RyxTQUFTMEIsY0FBYyxVQUNVLElBQTVDK0UsRUFBUzNELFVBQVU0RCxRQUFRLGFBQzdCRCxFQUFTM0QsVUFBWSxPQUNyQnRCLFNBQVNtRixjQUFjbEcsS0FBS1gsV0FBV3VCLEdBQUksV0FFM0NvRixFQUFTM0QsVUFBWSxnQkFDckJ0QixTQUFTbUYsY0FBY2xHLEtBQUtYLFdBQVd1QixHQUFJLFVBSzNDdUYsYUFBZSxXQUNqQixJQUFJQyxFQUFTLENBQ1h4RixHQUFJWixLQUFLWCxXQUFXa0MsUUFBUUcsT0FBUyxFQUNyQzJFLGNBQWVyRyxLQUFLWCxXQUFXdUIsR0FDL0JiLEtBQU1SLFNBQVNxQyxlQUFlLGdCQUFnQjBFLE1BQzlDQyxVQUFXLElBQUlyQyxLQUNmRyxPQUFRbUMsU0FBU2pILFNBQVNxQyxlQUFlLG1CQUFtQjBFLE9BQzVEaEMsU0FBVS9FLFNBQVNxQyxlQUFlLHFCQUFxQjBFLE9BR3pEdkYsU0FBUzBGLFdBQVdMLEdBQ3BCcEcsS0FBS1gsV0FBV2tDLFFBQVFtRixLQUFLTixHQUM3QnZEIiwiZmlsZSI6InJlc3RhdXJhbnRfaW5mby5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudFxyXG52YXIgbmV3TWFwXHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBtYXAgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZXZlbnQgPT4ge1xyXG4gIGluaXRNYXAoKVxyXG59KVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXBcclxuICovXHJcbmxldCBpbml0TWFwID0gKCkgPT4ge1xyXG4gIGZldGNoUmVzdGF1cmFudEZyb21VUkwoKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICAvLyBjb25zb2xlLmVycm9yKGVycm9yKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZG9jdW1lbnQudGl0bGUgPSBgUmVzdGF1cmFudCBSZXZpZXdzIC0gJHtyZXN0YXVyYW50Lm5hbWV9YFxyXG5cclxuICAgICAgc2VsZi5uZXdNYXAgPSBMLm1hcCgnbWFwJywge1xyXG4gICAgICAgIGNlbnRlcjogW3Jlc3RhdXJhbnQubGF0bG5nLmxhdCwgcmVzdGF1cmFudC5sYXRsbmcubG5nXSxcclxuICAgICAgICB6b29tOiAxNixcclxuICAgICAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXHJcbiAgICAgIH0pXHJcbiAgICAgIEwudGlsZUxheWVyKFxyXG4gICAgICAgICdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIG1hcGJveFRva2VuOlxyXG4gICAgICAgICAgICAncGsuZXlKMUlqb2lZbkpoWkhsMFptOXlaQ0lzSW1FaU9pSmphbWx5ZFRWblpuZ3dNWGxoTTNkeGJURTJOek5oYldOakluMC52UDU0VHJ1d1BvUFdRTFlaZFBLY3VnJyxcclxuICAgICAgICAgIG1heFpvb206IDE4LFxyXG4gICAgICAgICAgaWQ6ICdtYXBib3guc3RyZWV0cydcclxuICAgICAgICB9XHJcbiAgICAgICkuYWRkVG8obmV3TWFwKVxyXG4gICAgICBmaWxsQnJlYWRjcnVtYigpXHJcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBzZWxmLm5ld01hcClcclxuICAgIH1cclxuXHJcbiAgICBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignaW1nLmxlYWZsZXQtbWFya2VyLWljb24nKVxyXG4gICAgICAuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJycpXHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmxldCBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gY2FsbGJhY2sgPT4ge1xyXG4gIGlmIChzZWxmLnJlc3RhdXJhbnQpIHtcclxuICAgIC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxyXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KVxyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG4gIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpXHJcbiAgaWYgKCFpZCkge1xyXG4gICAgLy8gbm8gaWQgZm91bmQgaW4gVVJMXHJcbiAgICBlcnJvciA9ICdObyByZXN0YXVyYW50IGlkIGluIFVSTCdcclxuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKVxyXG4gIH0gZWxzZSB7XHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudFxyXG4gICAgICBpZiAoIXJlc3RhdXJhbnQpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmVycm9yKGVycm9yKVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgICB9XHJcbiAgICAgIERCSGVscGVyLmZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkKGlkLCAoZXJyb3IsIHJldmlld3MpID0+IHtcclxuICAgICAgICBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cyA9IHJldmlld3NcclxuICAgICAgICBmaWxsUmVzdGF1cmFudEhUTUwoKVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgcGFnZVxyXG4gKi9cclxubGV0IGZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKVxyXG4gIGNvbnN0IHN0YXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcclxuICBjb25zdCBjbGFzc1N0cmluZyA9IHJlc3RhdXJhbnQuaXNfZmF2b3JpdGUgPT09IHRydWUgPyAnc3RhciBmYXZvcml0ZScgOiAnc3RhcidcclxuICBzdGFyLnNldEF0dHJpYnV0ZSgnb25jbGljaycsICd0b2dnbGVGYXZvcml0ZSgpJylcclxuICBzdGFyLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBjbGFzc1N0cmluZylcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZVxyXG4gIG5hbWUuYXBwZW5kKHN0YXIpXHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJylcclxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzc1xyXG5cclxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWltZycpXHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJ1xyXG4gIGltYWdlLmFsdCA9IERCSGVscGVyLmltYWdlQWx0Zm9yUmVzdGF1cmFudChyZXN0YXVyYW50KVxyXG4gIGltYWdlLnNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KVxyXG5cclxuICBjb25zdCBjdWlzaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtY3Vpc2luZScpXHJcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZVxyXG5cclxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xyXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xyXG4gICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKVxyXG4gIH1cclxuICAvLyBmaWxsIHJldmlld3NcclxuICBmaWxsUmV2aWV3c0hUTUwoKVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgcGFnZS5cclxuICovXHJcbmxldCBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChcclxuICBvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnNcclxuKSA9PiB7XHJcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpXHJcbiAgZm9yIChsZXQga2V5IGluIG9wZXJhdGluZ0hvdXJzKSB7XHJcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpXHJcblxyXG4gICAgY29uc3QgZGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKVxyXG4gICAgZGF5LmlubmVySFRNTCA9IGtleVxyXG4gICAgcm93LmFwcGVuZENoaWxkKGRheSlcclxuXHJcbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKVxyXG4gICAgdGltZS5pbm5lckhUTUwgPSBvcGVyYXRpbmdIb3Vyc1trZXldXHJcbiAgICByb3cuYXBwZW5kQ2hpbGQodGltZSlcclxuXHJcbiAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSBqcGdhZ2UuXHJcbiAqL1xyXG5sZXQgZmlsbFJldmlld3NIVE1MID0gKHJldmlld3MgPSBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xyXG5cclxuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKVxyXG4gIGNvbnN0IHRpdGxlQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuICB0aXRsZUJveC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3RpdGxlQm94JylcclxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJylcclxuICB0aXRsZS5pbm5lckhUTUwgPSAnUmV2aWV3cydcclxuICB0aXRsZUJveC5hcHBlbmQodGl0bGUpXHJcbiAgY29udGFpbmVyLnByZXBlbmQodGl0bGVCb3gpXHJcblxyXG4gIGlmICghcmV2aWV3cykge1xyXG4gICAgY29uc3Qgbm9SZXZpZXdzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXHJcbiAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISdcclxuICAgIHRpdGxlQm94LmFwcGVuZENoaWxkKG5vUmV2aWV3cylcclxuICAgIHJldHVyblxyXG4gIH1cclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKVxyXG4gIHdoaWxlICh1bC5maXJzdENoaWxkKSB1bC5yZW1vdmVDaGlsZCh1bC5maXJzdENoaWxkKVxyXG4gIHJldmlld3MuZm9yRWFjaChyZXZpZXcgPT4ge1xyXG4gICAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKVxyXG4gIH0pXHJcbiAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlRm9ybSgpKVxyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bClcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSBqcGdhZ2UuXHJcbiAqL1xyXG5sZXQgY3JlYXRlUmV2aWV3SFRNTCA9IHJldmlldyA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhcnRpY2xlJylcclxuICBsaS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMClcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKVxyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWVcclxuICBsaS5hcHBlbmRDaGlsZChuYW1lKVxyXG5cclxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXHJcbiAgZGF0ZS5pbm5lckhUTUwgPSBuZXcgRGF0ZShyZXZpZXcudXBkYXRlZEF0KS50b0xvY2FsZVN0cmluZygpXHJcbiAgbGkuYXBwZW5kQ2hpbGQoZGF0ZSlcclxuXHJcbiAgY29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXHJcbiAgcmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ31gXHJcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKVxyXG5cclxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxyXG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50c1xyXG4gIGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKVxyXG5cclxuICByZXR1cm4gbGlcclxufVxyXG5cclxuLyoqXHJcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XHJcbiAqL1xyXG5sZXQgZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJlYWRjcnVtYicpXHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpXHJcbiAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lXHJcbiAgYnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSlcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBhIHBhcmFtZXRlciBieSBuYW1lIGZyb20gcGFnZSBVUkwuXHJcbiAqL1xyXG5sZXQgZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xyXG4gIGlmICghdXJsKSB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZlxyXG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKVxyXG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxyXG4gICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKVxyXG4gIGlmICghcmVzdWx0cykgcmV0dXJuIG51bGxcclxuICBpZiAoIXJlc3VsdHNbMl0pIHJldHVybiAnJ1xyXG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSlcclxufVxyXG5cclxuLyoqXHJcbiAqQ3JlYXRlIGZvcm0gdGlsZS5cclxuICovXHJcbmxldCBjcmVhdGVGb3JtID0gKCkgPT4ge1xyXG4gIGNvbnN0IGFydGljbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhcnRpY2xlJylcclxuXHJcbiAgLy9IZWFkZXJcclxuICBjb25zdCBoZWFkaW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKVxyXG4gIGhlYWRpbmcuaW5uZXJIVE1MID0gJ01pc3NpbmcgeW91ciBmYXZvcml0ZSBzcG90PydcclxuICBhcnRpY2xlLmFwcGVuZChoZWFkaW5nKVxyXG4gIGNvbnN0IHN1YmhlYWRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoNCcpXHJcbiAgc3ViaGVhZGluZy5pbm5lckhUTUwgPSAnQWRkIGEgcmVzdGF1cmFudCB0byBvdXIgbGlzdGluZ3MgYmVsb3cuJ1xyXG4gIGFydGljbGUuYXBwZW5kKHN1YmhlYWRpbmcpXHJcblxyXG4gIC8vRm9ybVxyXG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcclxuICBmb3JtLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgJ2phdmFzY3JpcHQ6dm9pZCgwKScpXHJcbiAgZm9ybS5zZXRBdHRyaWJ1dGUoJ29uc3VibWl0JywgJ3N1Ym1pdFJldmlldygpJylcclxuXHJcbiAgLy9GaXJzdCBJbnB1dFxyXG4gIGNvbnN0IGRpdjEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG5cclxuICBjb25zdCBsYWJlbDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXHJcbiAgbGFiZWwxLmlubmVySFRNTCA9ICdZb3VyIE5hbWUnXHJcbiAgbGFiZWwxLnNldEF0dHJpYnV0ZSgnZm9yJywgJ3Jldmlld2VyTmFtZScpXHJcbiAgZGl2MS5hcHBlbmQobGFiZWwxKVxyXG5cclxuICBjb25zdCBpbnB1dDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXHJcbiAgaW5wdXQxLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0JylcclxuICBpbnB1dDEuc2V0QXR0cmlidXRlKCduYW1lJywgJ3Jldmlld2VyTmFtZScpXHJcbiAgaW5wdXQxLnNldEF0dHJpYnV0ZSgnaWQnLCAncmV2aWV3ZXJOYW1lJylcclxuICBpbnB1dDEuc2V0QXR0cmlidXRlKCdyZXF1aXJlZCcsICdyZXF1aXJlZCcpXHJcbiAgZGl2MS5hcHBlbmQoaW5wdXQxKVxyXG5cclxuICBmb3JtLmFwcGVuZChkaXYxKVxyXG5cclxuICAvL1NlY29uZCBJbnB1dFxyXG4gIGNvbnN0IGRpdjIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG5cclxuICBjb25zdCBsYWJlbDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXHJcbiAgbGFiZWwyLmlubmVySFRNTCA9ICdSYXRpbmcgKDEtNSknXHJcbiAgbGFiZWwyLnNldEF0dHJpYnV0ZSgnZm9yJywgJ25ld1Jldmlld1JhdGluZycpXHJcbiAgZGl2Mi5hcHBlbmQobGFiZWwyKVxyXG5cclxuICBjb25zdCBpbnB1dDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXHJcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgndHlwZScsICdudW1iZXInKVxyXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ21pbicsICcxJylcclxuICBpbnB1dDIuc2V0QXR0cmlidXRlKCdtYXgnLCAnNScpXHJcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgnbmFtZScsICduZXdSZXZpZXdSYXRpbmcnKVxyXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ2lkJywgJ25ld1Jldmlld1JhdGluZycpXHJcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgncmVxdWlyZWQnLCAncmVxdWlyZWQnKVxyXG4gIGRpdjIuYXBwZW5kKGlucHV0MilcclxuXHJcbiAgZm9ybS5hcHBlbmQoZGl2MilcclxuXHJcbiAgLy9MYXN0IFVzZXIgSW5wdXRcclxuICBjb25zdCBkaXYzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuXHJcbiAgY29uc3QgbGFiZWwzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxyXG4gIGxhYmVsMy5pbm5lckhUTUwgPSAnQ29tbWVudHMnXHJcbiAgbGFiZWwzLnNldEF0dHJpYnV0ZSgnZm9yJywgJ25ld1Jldmlld0NvbW1lbnRzJylcclxuICBkaXYzLmFwcGVuZChsYWJlbDMpXHJcblxyXG4gIGNvbnN0IGlucHV0MyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJylcclxuICBpbnB1dDMuc2V0QXR0cmlidXRlKCduYW1lJywgJ25ld1Jldmlld0NvbW1lbnRzJylcclxuICBpbnB1dDMuc2V0QXR0cmlidXRlKCdpZCcsICduZXdSZXZpZXdDb21tZW50cycpXHJcbiAgaW5wdXQzLnNldEF0dHJpYnV0ZSgncm93cycsICc1JylcclxuICBpbnB1dDMuc2V0QXR0cmlidXRlKCdyZXF1aXJlZCcsICdyZXF1aXJlZCcpXHJcbiAgZGl2My5hcHBlbmQoaW5wdXQzKVxyXG5cclxuICBmb3JtLmFwcGVuZChkaXYzKVxyXG5cclxuICAvL3N1Ym1pdCBidXR0b25cclxuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxyXG4gIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnc3VibWl0JylcclxuICBidXR0b24uaW5uZXJIVE1MID0gJ1N1Ym1pdCdcclxuXHJcbiAgZm9ybS5hcHBlbmQoYnV0dG9uKVxyXG5cclxuICBhcnRpY2xlLmFwcGVuZChmb3JtKVxyXG5cclxuICByZXR1cm4gYXJ0aWNsZVxyXG59XHJcblxyXG5sZXQgdG9nZ2xlRmF2b3JpdGUgPSAoKSA9PiB7XHJcbiAgbGV0IHRoaXNTdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0YXInKVxyXG4gIGlmICh0aGlzU3Rhci5jbGFzc05hbWUuaW5kZXhPZignZmF2b3JpdGUnKSAhPT0gLTEpIHtcclxuICAgIHRoaXNTdGFyLmNsYXNzTmFtZSA9ICdzdGFyJ1xyXG4gICAgREJIZWxwZXIuc2VuZFRvZ2dsZUZhdihzZWxmLnJlc3RhdXJhbnQuaWQsICdmYWxzZScpXHJcbiAgfSBlbHNlIHtcclxuICAgIHRoaXNTdGFyLmNsYXNzTmFtZSA9ICdzdGFyIGZhdm9yaXRlJ1xyXG4gICAgREJIZWxwZXIuc2VuZFRvZ2dsZUZhdihzZWxmLnJlc3RhdXJhbnQuaWQsICd0cnVlJylcclxuICB9XHJcblxyXG59XHJcblxyXG5sZXQgc3VibWl0UmV2aWV3ID0gKCkgPT4ge1xyXG4gIGxldCBwYXJhbXMgPSB7XHJcbiAgICBpZDogc2VsZi5yZXN0YXVyYW50LnJldmlld3MubGVuZ3RoICsgMSxcclxuICAgIHJlc3RhdXJhbnRfaWQ6IHNlbGYucmVzdGF1cmFudC5pZCxcclxuICAgIG5hbWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdlck5hbWUnKS52YWx1ZSxcclxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgIHJhdGluZzogcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ld1Jldmlld1JhdGluZycpLnZhbHVlKSxcclxuICAgIGNvbW1lbnRzOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3UmV2aWV3Q29tbWVudHMnKS52YWx1ZVxyXG4gIH1cclxuXHJcbiAgREJIZWxwZXIuYWRkUmV2aWV3cyhwYXJhbXMpXHJcbiAgc2VsZi5yZXN0YXVyYW50LnJldmlld3MucHVzaChwYXJhbXMpXHJcbiAgZmlsbFJldmlld3NIVE1MKClcclxuXHJcbn0iXX0=
