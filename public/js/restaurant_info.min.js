"use strict";var restaurant,newMap;document.addEventListener("DOMContentLoaded",function(e){initMap()});var initMap=function(){fetchRestaurantFromURL(function(e,t){e||(document.title="Restaurant Reviews - ".concat(t.name),self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYnJhZHl0Zm9yZCIsImEiOiJjamlydTVnZngwMXlhM3dxbTE2NzNhbWNjIn0.vP54TruwPoPWQLYZdPKcug",maxZoom:18,id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap)),document.querySelector("img.leaflet-marker-icon").setAttribute("aria-label","")})},fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,function(e,n){(self.restaurant=n)&&DBHelper.fetchReviewsByRestaurantId(t,function(e,t){self.restaurant.reviews=t,fillRestaurantHTML(),r(null,n)})}):(error="No restaurant id in URL",r(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("restaurant-name"),n=document.createElement("span"),r=!0===e.is_favorite?"star favorite":"star";n.setAttribute("onclick","toggleFavorite()"),n.setAttribute("class",r),t.innerHTML=e.name,t.append(n),document.getElementById("restaurant-address").innerHTML=e.address;var a=document.getElementById("restaurant-img");a.className="restaurant-img",a.alt=DBHelper.imageAltforRestaurant(e),a.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=n,r.appendChild(a);var i=document.createElement("td");i.innerHTML=e[n],r.appendChild(i),t.appendChild(r)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("div");n.setAttribute("id","titleBox");var r=document.createElement("h2");if(r.innerHTML="Reviews",n.append(r),t.prepend(n),!e){var a=document.createElement("p");return a.innerHTML="No reviews yet!",void n.appendChild(a)}for(var i=document.getElementById("reviews-list");i.firstChild;)i.removeChild(i.firstChild);e.forEach(function(e){i.appendChild(createReviewHTML(e))}),i.appendChild(createForm()),t.appendChild(i)},createReviewHTML=function(e){var t=document.createElement("article");t.setAttribute("tabindex",0);var n=document.createElement("h3");n.innerHTML=e.name,t.appendChild(n);var r=document.createElement("p");r.innerHTML=new Date(e.updatedAt).toLocaleString(),t.appendChild(r);var a=document.createElement("p");a.innerHTML="Rating: ".concat(e.rating),t.appendChild(a);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},createForm=function(){var e=document.createElement("article"),t=document.createElement("h3");t.innerHTML="Missing your favorite spot?",e.append(t);var n=document.createElement("h4");n.innerHTML="Add a restaurant to our listings below.",e.append(n);var r=document.createElement("form");r.setAttribute("action","javascript:void(0)"),r.setAttribute("onsubmit","submitReview()");var a=document.createElement("div"),i=document.createElement("label");i.innerHTML="Your Name",i.setAttribute("for","reviewerName"),a.append(i);var u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("name","reviewerName"),u.setAttribute("id","reviewerName"),u.setAttribute("required","required"),a.append(u),r.append(a);var l=document.createElement("div"),d=document.createElement("label");d.innerHTML="Rating (1-5)",d.setAttribute("for","newReviewRating"),l.append(d);var s=document.createElement("input");s.setAttribute("type","number"),s.setAttribute("min","1"),s.setAttribute("max","5"),s.setAttribute("name","newReviewRating"),s.setAttribute("id","newReviewRating"),s.setAttribute("required","required"),l.append(s),r.append(l);var m=document.createElement("div"),o=document.createElement("label");o.innerHTML="Comments",o.setAttribute("for","newReviewComments"),m.append(o);var c=document.createElement("textarea");c.setAttribute("name","newReviewComments"),c.setAttribute("id","newReviewComments"),c.setAttribute("rows","5"),c.setAttribute("required","required"),m.append(c),r.append(m);var p=document.createElement("button");return p.setAttribute("type","submit"),p.innerHTML="Submit",r.append(p),e.append(r),e},toggleFavorite=function(){var e=document.querySelector(".star");-1!==e.className.indexOf("favorite")?(e.className="star",DBHelper.sendToggleFav(self.restaurant.id,"false")):(e.className="star favorite",DBHelper.sendToggleFav(self.restaurant.id,"true"))},submitReview=function(){var e={id:self.restaurant.reviews.length+1,restaurant_id:self.restaurant.id,name:document.getElementById("reviewerName").value,createdAt:new Date,rating:parseInt(document.getElementById("newReviewRating").value),comments:document.getElementById("newReviewComments").value};DBHelper.addReviews(e),self.restaurant.reviews.push(e),fillReviewsHTML()};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpbml0TWFwIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImVycm9yIiwidGl0bGUiLCJjb25jYXQiLCJuYW1lIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiaWQiLCJhZGRUbyIsImZpbGxCcmVhZGNydW1iIiwiREJIZWxwZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwicXVlcnlTZWxlY3RvciIsInNldEF0dHJpYnV0ZSIsImNhbGxiYWNrIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkIiwicmV2aWV3cyIsImZpbGxSZXN0YXVyYW50SFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImdldEVsZW1lbnRCeUlkIiwic3RhciIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc1N0cmluZyIsImlzX2Zhdm9yaXRlIiwiaW5uZXJIVE1MIiwiYXBwZW5kIiwiYWRkcmVzcyIsImltYWdlIiwiY2xhc3NOYW1lIiwiYWx0IiwiaW1hZ2VBbHRmb3JSZXN0YXVyYW50Iiwic3JjIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwiY3Vpc2luZV90eXBlIiwib3BlcmF0aW5nX2hvdXJzIiwiZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJmaWxsUmV2aWV3c0hUTUwiLCJvcGVyYXRpbmdIb3VycyIsImhvdXJzIiwia2V5Iiwicm93IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwiY29udGFpbmVyIiwidGl0bGVCb3giLCJwcmVwZW5kIiwibm9SZXZpZXdzIiwidWwiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJmb3JFYWNoIiwicmV2aWV3IiwiY3JlYXRlUmV2aWV3SFRNTCIsImNyZWF0ZUZvcm0iLCJsaSIsImRhdGUiLCJEYXRlIiwidXBkYXRlZEF0IiwidG9Mb2NhbGVTdHJpbmciLCJyYXRpbmciLCJjb21tZW50cyIsImJyZWFkY3J1bWIiLCJ1cmwiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJyZXBsYWNlIiwicmVzdWx0cyIsIlJlZ0V4cCIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiLCJhcnRpY2xlIiwiaGVhZGluZyIsInN1YmhlYWRpbmciLCJmb3JtIiwiZGl2MSIsImxhYmVsMSIsImlucHV0MSIsImRpdjIiLCJsYWJlbDIiLCJpbnB1dDIiLCJkaXYzIiwibGFiZWwzIiwiaW5wdXQzIiwiYnV0dG9uIiwidG9nZ2xlRmF2b3JpdGUiLCJ0aGlzU3RhciIsImluZGV4T2YiLCJzZW5kVG9nZ2xlRmF2Iiwic3VibWl0UmV2aWV3IiwicGFyYW1zIiwicmVzdGF1cmFudF9pZCIsInZhbHVlIiwiY3JlYXRlZEF0IiwicGFyc2VJbnQiLCJhZGRSZXZpZXdzIiwicHVzaCJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBSUEsV0FDQUMsT0FLSkMsU0FBU0MsaUJBQWlCLG1CQUFvQixTQUFBQyxHQUM1Q0MsWUFNRixJQUFJQSxRQUFVLFdBQ1pDLHVCQUF1QixTQUFDQyxFQUFPUCxHQUN6Qk8sSUFJRkwsU0FBU00sTUFBVCx3QkFBQUMsT0FBeUNULEVBQVdVLE1BRXBEQyxLQUFLVixPQUFTVyxFQUFFQyxJQUFJLE1BQU8sQ0FDekJDLE9BQVEsQ0FBQ2QsRUFBV2UsT0FBT0MsSUFBS2hCLEVBQVdlLE9BQU9FLEtBQ2xEQyxLQUFNLEdBQ05DLGlCQUFpQixJQUVuQlAsRUFBRVEsVUFDQSxvRkFDQSxDQUNFQyxZQUNFLGdHQUNGQyxRQUFTLEdBQ1RDLEdBQUksbUJBRU5DLE1BQU12QixRQUNSd0IsaUJBQ0FDLFNBQVNDLHVCQUF1QmhCLEtBQUtYLFdBQVlXLEtB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RCxHQUVaLElBQU1DLEVBQVN0RyxTQUFTdUMsY0FBYyxZQUN0QytELEVBQU8zRSxhQUFhLE9BQVEscUJBQzVCMkUsRUFBTzNFLGFBQWEsS0FBTSxxQkFDMUIyRSxFQUFPM0UsYUFBYSxPQUFRLEtBQzVCMkUsRUFBTzNFLGFBQWEsV0FBWSxZQUNoQ3lFLEVBQUt6RCxPQUFPMkQsR0FFWlQsRUFBS2xELE9BQU95RCxHQUdaLElBQU1HLEVBQVN2RyxTQUFTdUMsY0FBYyxVQVF0QyxPQVBBZ0UsRUFBTzVFLGFBQWEsT0FBUSxVQUM1QjRFLEVBQU83RCxVQUFZLFNBRW5CbUQsRUFBS2xELE9BQU80RCxHQUVaYixFQUFRL0MsT0FBT2tELEdBRVJILEdBR0xjLGVBQWlCLFdBQ25CLElBQUlDLEVBQVd6RyxTQUFTMEIsY0FBYyxVQUNVLElBQTVDK0UsRUFBUzNELFVBQVU0RCxRQUFRLGFBQzdCRCxFQUFTM0QsVUFBWSxPQUNyQnRCLFNBQVNtRixjQUFjbEcsS0FBS1gsV0FBV3VCLEdBQUksV0FFM0NvRixFQUFTM0QsVUFBWSxnQkFDckJ0QixTQUFTbUYsY0FBY2xHLEtBQUtYLFdBQVd1QixHQUFJLFVBSzNDdUYsYUFBZSxXQUNqQixJQUFJQyxFQUFTLENBQ1h4RixHQUFJWixLQUFLWCxXQUFXa0MsUUFBUUcsT0FBUyxFQUNyQzJFLGNBQWVyRyxLQUFLWCxXQUFXdUIsR0FDL0JiLEtBQU1SLFNBQVNxQyxlQUFlLGdCQUFnQjBFLE1BQzlDQyxVQUFXLElBQUlyQyxLQUNmRyxPQUFRbUMsU0FBU2pILFNBQVNxQyxlQUFlLG1CQUFtQjBFLE9BQzVEaEMsU0FBVS9FLFNBQVNxQyxlQUFlLHFCQUFxQjBFLE9BR3pEdkYsU0FBUzBGLFdBQVdMLEdBQ3BCcEcsS0FBS1gsV0FBV2tDLFFBQVFtRixLQUFLTixHQUM3QnZEIiwiZmlsZSI6InJlc3RhdXJhbnRfaW5mby5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudFxudmFyIG5ld01hcFxuXG4vKipcbiAqIEluaXRpYWxpemUgbWFwIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZXZlbnQgPT4ge1xuICBpbml0TWFwKClcbn0pXG5cbi8qKlxuICogSW5pdGlhbGl6ZSBsZWFmbGV0IG1hcFxuICovXG5sZXQgaW5pdE1hcCA9ICgpID0+IHtcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIC8vIEdvdCBhbiBlcnJvciFcbiAgICAgIC8vIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gICAgfSBlbHNlIHtcbiAgICAgIGRvY3VtZW50LnRpdGxlID0gYFJlc3RhdXJhbnQgUmV2aWV3cyAtICR7cmVzdGF1cmFudC5uYW1lfWBcblxuICAgICAgc2VsZi5uZXdNYXAgPSBMLm1hcCgnbWFwJywge1xuICAgICAgICBjZW50ZXI6IFtyZXN0YXVyYW50LmxhdGxuZy5sYXQsIHJlc3RhdXJhbnQubGF0bG5nLmxuZ10sXG4gICAgICAgIHpvb206IDE2LFxuICAgICAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXG4gICAgICB9KVxuICAgICAgTC50aWxlTGF5ZXIoXG4gICAgICAgICdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLFxuICAgICAgICB7XG4gICAgICAgICAgbWFwYm94VG9rZW46XG4gICAgICAgICAgICAncGsuZXlKMUlqb2lZbkpoWkhsMFptOXlaQ0lzSW1FaU9pSmphbWx5ZFRWblpuZ3dNWGxoTTNkeGJURTJOek5oYldOakluMC52UDU0VHJ1d1BvUFdRTFlaZFBLY3VnJyxcbiAgICAgICAgICBtYXhab29tOiAxOCxcbiAgICAgICAgICBpZDogJ21hcGJveC5zdHJlZXRzJ1xuICAgICAgICB9XG4gICAgICApLmFkZFRvKG5ld01hcClcbiAgICAgIGZpbGxCcmVhZGNydW1iKClcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBzZWxmLm5ld01hcClcbiAgICB9XG5cbiAgICBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJ2ltZy5sZWFmbGV0LW1hcmtlci1pY29uJylcbiAgICAgIC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnJylcbiAgfSlcbn1cblxuLyoqXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXG4gKi9cbmxldCBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gY2FsbGJhY2sgPT4ge1xuICBpZiAoc2VsZi5yZXN0YXVyYW50KSB7XG4gICAgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KVxuICAgIHJldHVyblxuICB9XG4gIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpXG4gIGlmICghaWQpIHtcbiAgICAvLyBubyBpZCBmb3VuZCBpbiBVUkxcbiAgICBlcnJvciA9ICdObyByZXN0YXVyYW50IGlkIGluIFVSTCdcbiAgICBjYWxsYmFjayhlcnJvciwgbnVsbClcbiAgfSBlbHNlIHtcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICAgIHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnRcbiAgICAgIGlmICghcmVzdGF1cmFudCkge1xuICAgICAgICAvLyBjb25zb2xlLmVycm9yKGVycm9yKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIERCSGVscGVyLmZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkKGlkLCAoZXJyb3IsIHJldmlld3MpID0+IHtcbiAgICAgICAgc2VsZi5yZXN0YXVyYW50LnJldmlld3MgPSByZXZpZXdzXG4gICAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpXG4gICAgICB9KVxuICAgIH0pXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHBhZ2VcbiAqL1xubGV0IGZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJylcbiAgY29uc3Qgc3RhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICBjb25zdCBjbGFzc1N0cmluZyA9IHJlc3RhdXJhbnQuaXNfZmF2b3JpdGUgPT09IHRydWUgPyAnc3RhciBmYXZvcml0ZScgOiAnc3RhcidcbiAgc3Rhci5zZXRBdHRyaWJ1dGUoJ29uY2xpY2snLCAndG9nZ2xlRmF2b3JpdGUoKScpXG4gIHN0YXIuc2V0QXR0cmlidXRlKCdjbGFzcycsIGNsYXNzU3RyaW5nKVxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZVxuICBuYW1lLmFwcGVuZChzdGFyKVxuXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJylcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3NcblxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWltZycpXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZydcbiAgaW1hZ2UuYWx0ID0gREJIZWxwZXIuaW1hZ2VBbHRmb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpXG4gIGltYWdlLnNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KVxuXG4gIGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1jdWlzaW5lJylcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZVxuXG4gIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKClcbiAgfVxuICAvLyBmaWxsIHJldmlld3NcbiAgZmlsbFJldmlld3NIVE1MKClcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSBwYWdlLlxuICovXG5sZXQgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAoXG4gIG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vyc1xuKSA9PiB7XG4gIGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKVxuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpXG5cbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpXG4gICAgZGF5LmlubmVySFRNTCA9IGtleVxuICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpXG5cbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKVxuICAgIHRpbWUuaW5uZXJIVE1MID0gb3BlcmF0aW5nSG91cnNba2V5XVxuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKVxuXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSBqcGdhZ2UuXG4gKi9cbmxldCBmaWxsUmV2aWV3c0hUTUwgPSAocmV2aWV3cyA9IHNlbGYucmVzdGF1cmFudC5yZXZpZXdzKSA9PiB7XG5cbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJylcbiAgY29uc3QgdGl0bGVCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICB0aXRsZUJveC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3RpdGxlQm94JylcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpXG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJ1xuICB0aXRsZUJveC5hcHBlbmQodGl0bGUpXG4gIGNvbnRhaW5lci5wcmVwZW5kKHRpdGxlQm94KVxuXG4gIGlmICghcmV2aWV3cykge1xuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJ1xuICAgIHRpdGxlQm94LmFwcGVuZENoaWxkKG5vUmV2aWV3cylcbiAgICByZXR1cm5cbiAgfVxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKVxuICB3aGlsZSAodWwuZmlyc3RDaGlsZCkgdWwucmVtb3ZlQ2hpbGQodWwuZmlyc3RDaGlsZClcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XG4gICAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKVxuICB9KVxuICB1bC5hcHBlbmRDaGlsZChjcmVhdGVGb3JtKCkpXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bClcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmV2aWV3IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUganBnYWdlLlxuICovXG5sZXQgY3JlYXRlUmV2aWV3SFRNTCA9IHJldmlldyA9PiB7XG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXJ0aWNsZScpXG4gIGxpLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKVxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKVxuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lXG4gIGxpLmFwcGVuZENoaWxkKG5hbWUpXG5cbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICBkYXRlLmlubmVySFRNTCA9IG5ldyBEYXRlKHJldmlldy51cGRhdGVkQXQpLnRvTG9jYWxlU3RyaW5nKClcbiAgbGkuYXBwZW5kQ2hpbGQoZGF0ZSlcblxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJylcbiAgcmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ31gXG4gIGxpLmFwcGVuZENoaWxkKHJhdGluZylcblxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHNcbiAgbGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpXG5cbiAgcmV0dXJuIGxpXG59XG5cbi8qKlxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcbiAqL1xubGV0IGZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJylcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpXG4gIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZVxuICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKVxufVxuXG4vKipcbiAqIEdldCBhIHBhcmFtZXRlciBieSBuYW1lIGZyb20gcGFnZSBVUkwuXG4gKi9cbmxldCBnZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG4gIGlmICghdXJsKSB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZlxuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJylcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBbPyZdJHtuYW1lfSg9KFteJiNdKil8JnwjfCQpYCksXG4gICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKVxuICBpZiAoIXJlc3VsdHMpIHJldHVybiBudWxsXG4gIGlmICghcmVzdWx0c1syXSkgcmV0dXJuICcnXG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSlcbn1cblxuLyoqXG4gKkNyZWF0ZSBmb3JtIHRpbGUuXG4gKi9cbmxldCBjcmVhdGVGb3JtID0gKCkgPT4ge1xuICBjb25zdCBhcnRpY2xlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXJ0aWNsZScpXG5cbiAgLy9IZWFkZXJcbiAgY29uc3QgaGVhZGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJylcbiAgaGVhZGluZy5pbm5lckhUTUwgPSAnTWlzc2luZyB5b3VyIGZhdm9yaXRlIHNwb3Q/J1xuICBhcnRpY2xlLmFwcGVuZChoZWFkaW5nKVxuICBjb25zdCBzdWJoZWFkaW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDQnKVxuICBzdWJoZWFkaW5nLmlubmVySFRNTCA9ICdBZGQgYSByZXN0YXVyYW50IHRvIG91ciBsaXN0aW5ncyBiZWxvdy4nXG4gIGFydGljbGUuYXBwZW5kKHN1YmhlYWRpbmcpXG5cbiAgLy9Gb3JtXG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcbiAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsICdqYXZhc2NyaXB0OnZvaWQoMCknKVxuICBmb3JtLnNldEF0dHJpYnV0ZSgnb25zdWJtaXQnLCAnc3VibWl0UmV2aWV3KCknKVxuXG4gIC8vRmlyc3QgSW5wdXRcbiAgY29uc3QgZGl2MSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cbiAgY29uc3QgbGFiZWwxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxuICBsYWJlbDEuaW5uZXJIVE1MID0gJ1lvdXIgTmFtZSdcbiAgbGFiZWwxLnNldEF0dHJpYnV0ZSgnZm9yJywgJ3Jldmlld2VyTmFtZScpXG4gIGRpdjEuYXBwZW5kKGxhYmVsMSlcblxuICBjb25zdCBpbnB1dDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gIGlucHV0MS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpXG4gIGlucHV0MS5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAncmV2aWV3ZXJOYW1lJylcbiAgaW5wdXQxLnNldEF0dHJpYnV0ZSgnaWQnLCAncmV2aWV3ZXJOYW1lJylcbiAgaW5wdXQxLnNldEF0dHJpYnV0ZSgncmVxdWlyZWQnLCAncmVxdWlyZWQnKVxuICBkaXYxLmFwcGVuZChpbnB1dDEpXG5cbiAgZm9ybS5hcHBlbmQoZGl2MSlcblxuICAvL1NlY29uZCBJbnB1dFxuICBjb25zdCBkaXYyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuICBjb25zdCBsYWJlbDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXG4gIGxhYmVsMi5pbm5lckhUTUwgPSAnUmF0aW5nICgxLTUpJ1xuICBsYWJlbDIuc2V0QXR0cmlidXRlKCdmb3InLCAnbmV3UmV2aWV3UmF0aW5nJylcbiAgZGl2Mi5hcHBlbmQobGFiZWwyKVxuXG4gIGNvbnN0IGlucHV0MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgndHlwZScsICdudW1iZXInKVxuICBpbnB1dDIuc2V0QXR0cmlidXRlKCdtaW4nLCAnMScpXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ21heCcsICc1JylcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgnbmFtZScsICduZXdSZXZpZXdSYXRpbmcnKVxuICBpbnB1dDIuc2V0QXR0cmlidXRlKCdpZCcsICduZXdSZXZpZXdSYXRpbmcnKVxuICBpbnB1dDIuc2V0QXR0cmlidXRlKCdyZXF1aXJlZCcsICdyZXF1aXJlZCcpXG4gIGRpdjIuYXBwZW5kKGlucHV0MilcblxuICBmb3JtLmFwcGVuZChkaXYyKVxuXG4gIC8vTGFzdCBVc2VyIElucHV0XG4gIGNvbnN0IGRpdjMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gIGNvbnN0IGxhYmVsMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcbiAgbGFiZWwzLmlubmVySFRNTCA9ICdDb21tZW50cydcbiAgbGFiZWwzLnNldEF0dHJpYnV0ZSgnZm9yJywgJ25ld1Jldmlld0NvbW1lbnRzJylcbiAgZGl2My5hcHBlbmQobGFiZWwzKVxuXG4gIGNvbnN0IGlucHV0MyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJylcbiAgaW5wdXQzLnNldEF0dHJpYnV0ZSgnbmFtZScsICduZXdSZXZpZXdDb21tZW50cycpXG4gIGlucHV0My5zZXRBdHRyaWJ1dGUoJ2lkJywgJ25ld1Jldmlld0NvbW1lbnRzJylcbiAgaW5wdXQzLnNldEF0dHJpYnV0ZSgncm93cycsICc1JylcbiAgaW5wdXQzLnNldEF0dHJpYnV0ZSgncmVxdWlyZWQnLCAncmVxdWlyZWQnKVxuICBkaXYzLmFwcGVuZChpbnB1dDMpXG5cbiAgZm9ybS5hcHBlbmQoZGl2MylcblxuICAvL3N1Ym1pdCBidXR0b25cbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgYnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdzdWJtaXQnKVxuICBidXR0b24uaW5uZXJIVE1MID0gJ1N1Ym1pdCdcblxuICBmb3JtLmFwcGVuZChidXR0b24pXG5cbiAgYXJ0aWNsZS5hcHBlbmQoZm9ybSlcblxuICByZXR1cm4gYXJ0aWNsZVxufVxuXG5sZXQgdG9nZ2xlRmF2b3JpdGUgPSAoKSA9PiB7XG4gIGxldCB0aGlzU3RhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdGFyJylcbiAgaWYgKHRoaXNTdGFyLmNsYXNzTmFtZS5pbmRleE9mKCdmYXZvcml0ZScpICE9PSAtMSkge1xuICAgIHRoaXNTdGFyLmNsYXNzTmFtZSA9ICdzdGFyJ1xuICAgIERCSGVscGVyLnNlbmRUb2dnbGVGYXYoc2VsZi5yZXN0YXVyYW50LmlkLCAnZmFsc2UnKVxuICB9IGVsc2Uge1xuICAgIHRoaXNTdGFyLmNsYXNzTmFtZSA9ICdzdGFyIGZhdm9yaXRlJ1xuICAgIERCSGVscGVyLnNlbmRUb2dnbGVGYXYoc2VsZi5yZXN0YXVyYW50LmlkLCAndHJ1ZScpXG4gIH1cblxufVxuXG5sZXQgc3VibWl0UmV2aWV3ID0gKCkgPT4ge1xuICBsZXQgcGFyYW1zID0ge1xuICAgIGlkOiBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cy5sZW5ndGggKyAxLFxuICAgIHJlc3RhdXJhbnRfaWQ6IHNlbGYucmVzdGF1cmFudC5pZCxcbiAgICBuYW1lOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3ZXJOYW1lJykudmFsdWUsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIHJhdGluZzogcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ld1Jldmlld1JhdGluZycpLnZhbHVlKSxcbiAgICBjb21tZW50czogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ld1Jldmlld0NvbW1lbnRzJykudmFsdWVcbiAgfVxuXG4gIERCSGVscGVyLmFkZFJldmlld3MocGFyYW1zKVxuICBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cy5wdXNoKHBhcmFtcylcbiAgZmlsbFJldmlld3NIVE1MKClcblxufSJdfQ==
