"use strict";var restaurant,newMap;document.addEventListener("DOMContentLoaded",function(e){initMap()});var initMap=function(){fetchRestaurantFromURL(function(e,t){e||(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYnJhZHl0Zm9yZCIsImEiOiJjamlydTVnZngwMXlhM3dxbTE2NzNhbWNjIn0.vP54TruwPoPWQLYZdPKcug",maxZoom:18,id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap)),document.querySelector("img.leaflet-marker-icon").setAttribute("aria-label","")})},fetchRestaurantFromURL=function(a){if(self.restaurant)a(null,self.restaurant);else{var t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,function(e,n){(self.restaurant=n)&&DBHelper.fetchReviewsByRestaurantId(t,function(e,t){self.restaurant.reviews=t,fillRestaurantHTML(),a(null,n)})}):(error="No restaurant id in URL",a(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=document.getElementById("restaurant-img");t.className="restaurant-img",t.alt=DBHelper.imageAltforRestaurant(e),t.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,a.appendChild(r);var i=document.createElement("td");i.innerHTML=e[n],a.appendChild(i),t.appendChild(a)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("div");n.setAttribute("id","titleBox");var a=document.createElement("h2");if(a.innerHTML="Reviews",n.append(a),t.prepend(n),!e){var r=document.createElement("p");return r.innerHTML="No reviews yet!",void n.appendChild(r)}var i=document.getElementById("reviews-list");e.forEach(function(e){i.appendChild(createReviewHTML(e))}),t.appendChild(i)},createReviewHTML=function(e){var t=document.createElement("article");t.setAttribute("tabindex",0);var n=document.createElement("h3");n.innerHTML=e.name,t.appendChild(n);var a=document.createElement("p");a.innerHTML=new Date(e.updatedAt).toLocaleString(),t.appendChild(a);var r=document.createElement("p");r.innerHTML="Rating: ".concat(e.rating),t.appendChild(r);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpbml0TWFwIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImVycm9yIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiaWQiLCJhZGRUbyIsImZpbGxCcmVhZGNydW1iIiwiREJIZWxwZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwicXVlcnlTZWxlY3RvciIsInNldEF0dHJpYnV0ZSIsImNhbGxiYWNrIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkIiwicmV2aWV3TGlzdCIsInJldmlld3MiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsIm5hbWUiLCJhZGRyZXNzIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJhbHQiLCJpbWFnZUFsdGZvclJlc3RhdXJhbnQiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJjdWlzaW5lX3R5cGUiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZpbGxSZXZpZXdzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiaG91cnMiLCJrZXkiLCJyb3ciLCJjcmVhdGVFbGVtZW50IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwiY29udGFpbmVyIiwidGl0bGVCb3giLCJ0aXRsZSIsImFwcGVuZCIsInByZXBlbmQiLCJub1Jldmlld3MiLCJ1bCIsImZvckVhY2giLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwibGkiLCJkYXRlIiwiRGF0ZSIsInVwZGF0ZWRBdCIsInRvTG9jYWxlU3RyaW5nIiwicmF0aW5nIiwiY29uY2F0IiwiY29tbWVudHMiLCJicmVhZGNydW1iIiwidXJsIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwicmVwbGFjZSIsInJlc3VsdHMiLCJSZWdFeHAiLCJleGVjIiwiZGVjb2RlVVJJQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoiYUFBQSxJQUFJQSxXQUNBQyxPQUtKQyxTQUFTQyxpQkFBaUIsbUJBQW9CLFNBQUFDLEdBQzVDQyxZQU1GLElBQUlBLFFBQVUsV0FDWkMsdUJBQXVCLFNBQUNDLEVBQU9QLEdBQ3pCTyxJQUlGQyxLQUFLUCxPQUFTUSxFQUFFQyxJQUFJLE1BQU8sQ0FDekJDLE9BQVEsQ0FBQ1gsRUFBV1ksT0FBT0MsSUFBS2IsRUFBV1ksT0FBT0UsS0FDbERDLEtBQU0sR0FDTkMsaUJBQWlCLElBRW5CUCxFQUFFUSxVQUNBLG9GQUNBLENBQ0VDLFlBQ0UsZ0dBQ0ZDLFFBQVMsR0FDVEMsR0FBSSxtQkFFTkMsTUFBTXBCLFFBQ1JxQixpQkFDQUMsU0FBU0MsdUJBQXVCaEIsS0FBS1IsV0FBWVEsS0FBS1AsU0FHeERDLFNBQ0d1QixjQUFjLDJCQUNkQyxhQUFhLGFBQWMsT0FPOUJwQix1QkFBeUIsU0FBQXFCLEdBQzNCLEdBQUluQixLQUFLUixXQUVQMkIsRUFBUyxLQUFNbkIsS0FBS1IsZ0JBRnRCLENBS0EsSUFBTW9CLEVBQUtRLG1CQUFtQixNQUN6QlIsRUFLSEcsU0FBU00sb0JBQW9CVCxFQUFJLFNBQUNiLEVBQU9QLElBQ3ZDUSxLQUFLUixXQUFhQSxJQUtsQnVCLFNBQVNPLDJCQUEyQlYsRUFBSSxTQUFDYixFQUFPd0IsR0FDOUN2QixLQUFLUixXQUFXZ0MsUUFBVUQsRUFDMUJFLHFCQUNBTixFQUFTLEtBQU0zQixRQVpuQk8sTUFBUSwwQkFDUm9CLEVBQVNwQixNQUFPLFNBb0JoQjBCLG1CQUFxQixXQUFrQyxJQUFqQ2pDLEVBQWlDLEVBQUFrQyxV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QyxNQUNoQzFDLEVBQU9BLEVBQUsyQyxRQUFRLFVBQVcsUUFDL0IsSUFDRUMsRUFEWSxJQUFJQyxPQUFKLE9BQUFULE9BQWtCcEMsRUFBbEIsc0JBQ0k4QyxLQUFLUCxHQUN2QixPQUFLSyxFQUNBQSxFQUFRLEdBQ05HLG1CQUFtQkgsRUFBUSxHQUFHRCxRQUFRLE1BQU8sTUFENUIsR0FESCIsImZpbGUiOiJyZXN0YXVyYW50X2luZm8ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRcbnZhciBuZXdNYXBcblxuLyoqXG4gKiBJbml0aWFsaXplIG1hcCBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGV2ZW50ID0+IHtcbiAgaW5pdE1hcCgpXG59KVxuXG4vKipcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXBcbiAqL1xubGV0IGluaXRNYXAgPSAoKSA9PiB7XG4gIGZldGNoUmVzdGF1cmFudEZyb21VUkwoKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICAvLyBHb3QgYW4gZXJyb3IhXG4gICAgICAvLyBjb25zb2xlLmVycm9yKGVycm9yKVxuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XG4gICAgICAgIGNlbnRlcjogW3Jlc3RhdXJhbnQubGF0bG5nLmxhdCwgcmVzdGF1cmFudC5sYXRsbmcubG5nXSxcbiAgICAgICAgem9vbTogMTYsXG4gICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2VcbiAgICAgIH0pXG4gICAgICBMLnRpbGVMYXllcihcbiAgICAgICAgJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsXG4gICAgICAgIHtcbiAgICAgICAgICBtYXBib3hUb2tlbjpcbiAgICAgICAgICAgICdway5leUoxSWpvaVluSmhaSGwwWm05eVpDSXNJbUVpT2lKamFtbHlkVFZuWm5nd01YbGhNM2R4YlRFMk56TmhiV05qSW4wLnZQNTRUcnV3UG9QV1FMWVpkUEtjdWcnLFxuICAgICAgICAgIG1heFpvb206IDE4LFxuICAgICAgICAgIGlkOiAnbWFwYm94LnN0cmVldHMnXG4gICAgICAgIH1cbiAgICAgICkuYWRkVG8obmV3TWFwKVxuICAgICAgZmlsbEJyZWFkY3J1bWIoKVxuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubmV3TWFwKVxuICAgIH1cblxuICAgIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignaW1nLmxlYWZsZXQtbWFya2VyLWljb24nKVxuICAgICAgLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICcnKVxuICB9KVxufVxuXG4vKipcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cbiAqL1xubGV0IGZldGNoUmVzdGF1cmFudEZyb21VUkwgPSBjYWxsYmFjayA9PiB7XG4gIGlmIChzZWxmLnJlc3RhdXJhbnQpIHtcbiAgICAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcbiAgICBjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpXG4gICAgcmV0dXJuXG4gIH1cbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJylcbiAgaWYgKCFpZCkge1xuICAgIC8vIG5vIGlkIGZvdW5kIGluIFVSTFxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKVxuICB9IGVsc2Uge1xuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudFxuICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XG4gICAgICAgIC8vIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgREJIZWxwZXIuZmV0Y2hSZXZpZXdzQnlSZXN0YXVyYW50SWQoaWQsIChlcnJvciwgcmV2aWV3TGlzdCkgPT4ge1xuICAgICAgICBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cyA9IHJldmlld0xpc3RcbiAgICAgICAgZmlsbFJlc3RhdXJhbnRIVE1MKClcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudClcbiAgICAgIH0pXG4gICAgfSlcbiAgfSAgIFxufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUganBnYWdlXG4gKi9cbmxldCBmaWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lXG5cbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWFkZHJlc3MnKVxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzc1xuXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJylcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJ1xuICBpbWFnZS5hbHQgPSBEQkhlbHBlci5pbWFnZUFsdGZvclJlc3RhdXJhbnQocmVzdGF1cmFudClcbiAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpXG5cbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKVxuICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlXG5cbiAgLy8gZmlsbCBvcGVyYXRpbmcgaG91cnNcbiAgaWYgKHJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSB7XG4gICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKVxuICB9XG4gIC8vIGZpbGwgcmV2aWV3c1xuICBmaWxsUmV2aWV3c0hUTUwoKVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IG9wZXJhdGluZyBob3VycyBIVE1MIHRhYmxlIGFuZCBhZGQgaXQgdG8gdGhlIHBhZ2UuXG4gKi9cbmxldCBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChcbiAgb3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzXG4pID0+IHtcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpXG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJylcblxuICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJylcbiAgICBkYXkuaW5uZXJIVE1MID0ga2V5XG4gICAgcm93LmFwcGVuZENoaWxkKGRheSlcblxuICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpXG4gICAgdGltZS5pbm5lckhUTUwgPSBvcGVyYXRpbmdIb3Vyc1trZXldXG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpXG5cbiAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIGpwZ2FnZS5cbiAqL1xubGV0IGZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXN0YXVyYW50LnJldmlld3MpID0+IHtcblxuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKVxuICBjb25zdCB0aXRsZUJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gIHRpdGxlQm94LnNldEF0dHJpYnV0ZSgnaWQnLCAndGl0bGVCb3gnKVxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJylcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnXG4gIHRpdGxlQm94LmFwcGVuZCh0aXRsZSlcbiAgY29udGFpbmVyLnByZXBlbmQodGl0bGVCb3gpXG5cbiAgaWYgKCFyZXZpZXdzKSB7XG4gICAgY29uc3Qgbm9SZXZpZXdzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnXG4gICAgdGl0bGVCb3guYXBwZW5kQ2hpbGQobm9SZXZpZXdzKVxuICAgIHJldHVyblxuICB9XG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpXG4gIHJldmlld3MuZm9yRWFjaChyZXZpZXcgPT4ge1xuICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSlcbiAgfSlcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHVsKVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSBqcGdhZ2UuXG4gKi9cbmxldCBjcmVhdGVSZXZpZXdIVE1MID0gcmV2aWV3ID0+IHtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhcnRpY2xlJylcbiAgbGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpXG4gIG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWVcbiAgbGkuYXBwZW5kQ2hpbGQobmFtZSlcblxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gIGRhdGUuaW5uZXJIVE1MID0gbmV3IERhdGUocmV2aWV3LnVwZGF0ZWRBdCkudG9Mb2NhbGVTdHJpbmcoKVxuICBsaS5hcHBlbmRDaGlsZChkYXRlKVxuXG4gIGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWBcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKVxuXG4gIGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50c1xuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cylcblxuICByZXR1cm4gbGlcbn1cblxuLyoqXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxuICovXG5sZXQgZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBicmVhZGNydW1iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JyZWFkY3J1bWInKVxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJylcbiAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lXG4gIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpXG59XG5cbi8qKlxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cbiAqL1xubGV0IGdldFBhcmFtZXRlckJ5TmFtZSA9IChuYW1lLCB1cmwpID0+IHtcbiAgaWYgKCF1cmwpIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmXG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKVxuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpXG4gIGlmICghcmVzdWx0cykgcmV0dXJuIG51bGxcbiAgaWYgKCFyZXN1bHRzWzJdKSByZXR1cm4gJydcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKVxufVxuIl19
