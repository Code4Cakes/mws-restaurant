"use strict";var restaurant,newMap;document.addEventListener("DOMContentLoaded",function(e){initMap()});var initMap=function(){fetchRestaurantFromURL(function(e,t){e||(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYnJhZHl0Zm9yZCIsImEiOiJjamlydTVnZngwMXlhM3dxbTE2NzNhbWNjIn0.vP54TruwPoPWQLYZdPKcug",maxZoom:18,id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap)),document.querySelector("img.leaflet-marker-icon").setAttribute("aria-label","")})},fetchRestaurantFromURL=function(n){if(self.restaurant)n(null,self.restaurant);else{var e=getParameterByName("id");e?DBHelper.fetchRestaurantById(e,function(e,t){(self.restaurant=t)&&(fillRestaurantHTML(),n(null,t))}):(error="No restaurant id in URL",n(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=document.getElementById("restaurant-img");t.className="restaurant-img",t.alt=DBHelper.imageAltforRestaurant(e),t.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,a.appendChild(r);var l=document.createElement("td");l.innerHTML=e[n],a.appendChild(l),t.appendChild(a)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("h2");if(n.innerHTML="Reviews",t.appendChild(n),!e){var a=document.createElement("p");return a.innerHTML="No reviews yet!",void t.appendChild(a)}var r=document.getElementById("reviews-list");e.forEach(function(e){r.appendChild(createReviewHTML(e))}),t.appendChild(r)},createReviewHTML=function(e){var t=document.createElement("article");t.setAttribute("tabindex",0);var n=document.createElement("h3");n.innerHTML=e.name,t.appendChild(n);var a=document.createElement("p");a.innerHTML=e.date,t.appendChild(a);var r=document.createElement("p");r.innerHTML="Rating: ".concat(e.rating),t.appendChild(r);var l=document.createElement("p");return l.innerHTML=e.comments,t.appendChild(l),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpbml0TWFwIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImVycm9yIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiaWQiLCJhZGRUbyIsImZpbGxCcmVhZGNydW1iIiwiREJIZWxwZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwicXVlcnlTZWxlY3RvciIsInNldEF0dHJpYnV0ZSIsImNhbGxiYWNrIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZpbGxSZXN0YXVyYW50SFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJIVE1MIiwibmFtZSIsImFkZHJlc3MiLCJpbWFnZSIsImNsYXNzTmFtZSIsImFsdCIsImltYWdlQWx0Zm9yUmVzdGF1cmFudCIsInNyYyIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsImN1aXNpbmVfdHlwZSIsIm9wZXJhdGluZ19ob3VycyIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwiZmlsbFJldmlld3NIVE1MIiwib3BlcmF0aW5nSG91cnMiLCJob3VycyIsImtleSIsInJvdyIsImNyZWF0ZUVsZW1lbnQiLCJkYXkiLCJhcHBlbmRDaGlsZCIsInRpbWUiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwidGl0bGUiLCJub1Jldmlld3MiLCJ1bCIsImZvckVhY2giLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwibGkiLCJkYXRlIiwicmF0aW5nIiwiY29uY2F0IiwiY29tbWVudHMiLCJicmVhZGNydW1iIiwidXJsIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwicmVwbGFjZSIsInJlc3VsdHMiLCJSZWdFeHAiLCJleGVjIiwiZGVjb2RlVVJJQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoiYUFBQSxJQUFJQSxXQUNBQyxPQUtKQyxTQUFTQyxpQkFBaUIsbUJBQW9CLFNBQUFDLEdBQzVDQyxZQU1GLElBQUlBLFFBQVUsV0FDWkMsdUJBQXVCLFNBQUNDLEVBQU9QLEdBQ3pCTyxJQUlGQyxLQUFLUCxPQUFTUSxFQUFFQyxJQUFJLE1BQU8sQ0FDekJDLE9BQVEsQ0FBQ1gsRUFBV1ksT0FBT0MsSUFBS2IsRUFBV1ksT0FBT0UsS0FDbERDLEtBQU0sR0FDTkMsaUJBQWlCLElBRW5CUCxFQUFFUSxVQUNBLG9GQUNBLENBQ0VDLFlBQ0UsZ0dBQ0ZDLFFBQVMsR0FDVEMsR0FBSSxtQkFFTkMsTUFBTXBCLFFBQ1JxQixpQkFDQUMsU0FBU0MsdUJBQXVCaEIsS0FBS1IsV0FBWVEsS0FBS1AsU0FHeERDLFNBQ0d1QixjQUFjLDJCQUNkQyxhQUFhLGFBQWMsT0FPOUJwQix1QkFBeUIsU0FBQXFCLEdBQzNCLEdBQUluQixLQUFLUixXQUVQMkIsRUFBUyxLQUFNbkIsS0FBS1IsZ0JBRnRCLENBS0EsSUFBTW9CLEVBQUtRLG1CQUFtQixNQUN6QlIsRUFLSEcsU0FBU00sb0JBQW9CVCxFQUFJLFNBQUNiLEVBQU9QLElBQ3ZDUSxLQUFLUixXQUFhQSxLQUtsQjhCLHFCQUNBSCxFQUFTLEtBQU0zQixPQVZqQk8sTUFBUSwwQkFDUm9CLEVBQVNwQixNQUFPLFNBaUJoQnVCLG1CQUFxQixXQUFrQyxJQUFqQzlCLEVBQWlDLEVBQUErQixVQUFBQyxhQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBcEJ2QixLQUFLUixXQUM3QkUsU0FBU2dDLGVBQWUsbUJBQ2hDQyxVQUFZbkMsRUFBV29DLEtBRVpsQyxTQUFTZ0MsZUFBZSxzQkFDaENDLFVBQVluQyxFQUFXcUMsUUFFL0IsSUFBTUMsRUFBUXBDLFNBQVNnQyxlQUFlLGtCQUN0Q0ksRUFBTUMsVUFBWSxpQkFDbEJELEVBQU1FLElBQU1qQixTQUFTa0Isc0JBQXNCekMsR0FDM0NzQyxFQUFNSSxJQUFNbkIsU0FBU29CLHNCQUFzQjNDLEdBRTNCRSxTQUFTZ0MsZUFBZSxzQkFDaENDLFVBQVluQyxFQUFXNEMsYUFHM0I1QyxFQUFXNkMsaUJBQ2JDLDBCQUdGQyxtQkFNRUQsd0JBQTBCLFdBRXpCLElBREhFLEVBQ0csRUFBQWpCLFVBQUFDLGFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQURjdkIsS0FBS1IsV0FBVzZDLGdCQUUzQkksRUFBUS9DLFNBQVNnQyxlQUFlLG9CQUN0QyxJQUFLLElBQUlnQixLQUFPRixFQUFnQixDQUM5QixJQUFNRyxFQUFNakQsU0FBU2tELGNBQWMsTUFFN0JDLEVBQU1uRCxTQUFTa0QsY0FBYyxNQUNuQ0MsRUFBSWxCLFVBQVllLEVBQ2hCQyxFQUFJRyxZQUFZRCxHQUVoQixJQUFNRSxFQUFPckQsU0FBU2tELGNBQWMsTUFDcENHLEVBQUtwQixVQUFZYSxFQUFlRSxHQUNoQ0MsRUFBSUcsWUFBWUMsR0FFaEJOLEVBQU1LLFlBQVlILEtBT2xCSixnQkFBa0IsV0FBdUMsSUFBdENTLEVBQXNDLEVBQUF6QixVQUFBQyxhQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBNUJ2QixLQUFLUixXQUFXd0QsUUFDekNDLEVBQVl2RCxTQUFTZ0MsZUFBZSxxQkFDcEN3QixFQUFReEQsU0FBU2tELGNBQWMsTUFJckMsR0FIQU0sRUFBTXZCLFVBQVksVUFDbEJzQixFQUFVSCxZQUFZSSxJQUVqQkYsRUFBUyxDQUNaLElBQU1HLEVBQVl6RCxTQUFTa0QsY0FBYyxLQUd6QyxPQUZBTyxFQUFVeEIsVUFBWSx1QkFDdEJzQixFQUFVSCxZQUFZSyxHQUd4QixJQUFNQyxFQUFLMUQsU0FBU2dDLGVBQWUsZ0JBQ25Dc0IsRUFBUUssUUFBUSxTQUFBQyxHQUNkRixFQUFHTixZQUFZUyxpQkFBaUJELE1BRWxDTCxFQUFVSCxZQUFZTSxJQU1wQkcsaUJBQW1CLFNBQUFELEdBQ3JCLElBQU1FLEVBQUs5RCxTQUFTa0QsY0FBYyxXQUNsQ1ksRUFBR3RDLGFBQWEsV0FBWSxHQUM1QixJQUFNVSxFQUFPbEMsU0FBU2tELGNBQWMsTUFDcENoQixFQUFLRCxVQUFZMkIsRUFBTzFCLEtBQ3hCNEIsRUFBR1YsWUFBWWxCLEdBRWYsSUFBTTZCLEVBQU8vRCxTQUFTa0QsY0FBYyxLQUNwQ2EsRUFBSzlCLFVBQVkyQixFQUFPRyxLQUN4QkQsRUFBR1YsWUFBWVcsR0FFZixJQUFNQyxFQUFTaEUsU0FBU2tELGNBQWMsS0FDdENjLEVBQU8vQixVQUFQLFdBQUFnQyxPQUE4QkwsRUFBT0ksUUFDckNGLEVBQUdWLFlBQVlZLEdBRWYsSUFBTUUsRUFBV2xFLFNBQVNrRCxjQUFjLEtBSXhDLE9BSEFnQixFQUFTakMsVUFBWTJCLEVBQU9NLFNBQzVCSixFQUFHVixZQUFZYyxHQUVSSixHQU1MMUMsZUFBaUIsV0FBa0MsSUFBakN0QixFQUFpQyxFQUFBK0IsVUFBQUMsYUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQXBCdkIsS0FBS1IsV0FDaENxRSxFQUFhbkUsU0FBU2dDLGVBQWUsY0FDckM4QixFQUFLOUQsU0FBU2tELGNBQWMsTUFDbENZLEVBQUc3QixVQUFZbkMsRUFBV29DLEtBQzFCaUMsRUFBV2YsWUFBWVUsSUFNckJwQyxtQkFBcUIsU0FBQ1EsRUFBTWtDLEdBQ3pCQSxJQUFLQSxFQUFNQyxPQUFPQyxTQUFTQyxNQUNoQ3JDLEVBQU9BLEVBQUtzQyxRQUFRLFVBQVcsUUFDL0IsSUFDRUMsRUFEWSxJQUFJQyxPQUFKLE9BQUFULE9BQWtCL0IsRUFBbEIsc0JBQ0l5QyxLQUFLUCxHQUN2QixPQUFLSyxFQUNBQSxFQUFRLEdBQ05HLG1CQUFtQkgsRUFBUSxHQUFHRCxRQUFRLE1BQU8sTUFENUIsR0FESCIsImZpbGUiOiJyZXN0YXVyYW50X2luZm8ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRcbnZhciBuZXdNYXBcblxuLyoqXG4gKiBJbml0aWFsaXplIG1hcCBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGV2ZW50ID0+IHtcbiAgaW5pdE1hcCgpXG59KVxuXG4vKipcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXBcbiAqL1xubGV0IGluaXRNYXAgPSAoKSA9PiB7XG4gIGZldGNoUmVzdGF1cmFudEZyb21VUkwoKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICAvLyBHb3QgYW4gZXJyb3IhXG4gICAgICAvLyBjb25zb2xlLmVycm9yKGVycm9yKVxuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XG4gICAgICAgIGNlbnRlcjogW3Jlc3RhdXJhbnQubGF0bG5nLmxhdCwgcmVzdGF1cmFudC5sYXRsbmcubG5nXSxcbiAgICAgICAgem9vbTogMTYsXG4gICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2VcbiAgICAgIH0pXG4gICAgICBMLnRpbGVMYXllcihcbiAgICAgICAgJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsXG4gICAgICAgIHtcbiAgICAgICAgICBtYXBib3hUb2tlbjpcbiAgICAgICAgICAgICdway5leUoxSWpvaVluSmhaSGwwWm05eVpDSXNJbUVpT2lKamFtbHlkVFZuWm5nd01YbGhNM2R4YlRFMk56TmhiV05qSW4wLnZQNTRUcnV3UG9QV1FMWVpkUEtjdWcnLFxuICAgICAgICAgIG1heFpvb206IDE4LFxuICAgICAgICAgIGlkOiAnbWFwYm94LnN0cmVldHMnXG4gICAgICAgIH1cbiAgICAgICkuYWRkVG8obmV3TWFwKVxuICAgICAgZmlsbEJyZWFkY3J1bWIoKVxuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubmV3TWFwKVxuICAgIH1cblxuICAgIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignaW1nLmxlYWZsZXQtbWFya2VyLWljb24nKVxuICAgICAgLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICcnKVxuICB9KVxufVxuXG4vKipcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cbiAqL1xubGV0IGZldGNoUmVzdGF1cmFudEZyb21VUkwgPSBjYWxsYmFjayA9PiB7XG4gIGlmIChzZWxmLnJlc3RhdXJhbnQpIHtcbiAgICAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcbiAgICBjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpXG4gICAgcmV0dXJuXG4gIH1cbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJylcbiAgaWYgKCFpZCkge1xuICAgIC8vIG5vIGlkIGZvdW5kIGluIFVSTFxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKVxuICB9IGVsc2Uge1xuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudFxuICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XG4gICAgICAgIC8vIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgZmlsbFJlc3RhdXJhbnRIVE1MKClcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpXG4gICAgfSlcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUganBnYWdlXG4gKi9cbmxldCBmaWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lXG5cbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWFkZHJlc3MnKVxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzc1xuXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJylcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJ1xuICBpbWFnZS5hbHQgPSBEQkhlbHBlci5pbWFnZUFsdGZvclJlc3RhdXJhbnQocmVzdGF1cmFudClcbiAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpXG5cbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKVxuICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlXG5cbiAgLy8gZmlsbCBvcGVyYXRpbmcgaG91cnNcbiAgaWYgKHJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSB7XG4gICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKVxuICB9XG4gIC8vIGZpbGwgcmV2aWV3c1xuICBmaWxsUmV2aWV3c0hUTUwoKVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IG9wZXJhdGluZyBob3VycyBIVE1MIHRhYmxlIGFuZCBhZGQgaXQgdG8gdGhlIGpwZ2FnZS5cbiAqL1xubGV0IGZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKFxuICBvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnNcbikgPT4ge1xuICBjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJylcbiAgZm9yIChsZXQga2V5IGluIG9wZXJhdGluZ0hvdXJzKSB7XG4gICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKVxuXG4gICAgY29uc3QgZGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKVxuICAgIGRheS5pbm5lckhUTUwgPSBrZXlcbiAgICByb3cuYXBwZW5kQ2hpbGQoZGF5KVxuXG4gICAgY29uc3QgdGltZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJylcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV1cbiAgICByb3cuYXBwZW5kQ2hpbGQodGltZSlcblxuICAgIGhvdXJzLmFwcGVuZENoaWxkKHJvdylcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSBhbGwgcmV2aWV3cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUganBnYWdlLlxuICovXG5sZXQgZmlsbFJldmlld3NIVE1MID0gKHJldmlld3MgPSBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKVxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJylcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aXRsZSlcblxuICBpZiAoIXJldmlld3MpIHtcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJylcbiAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISdcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKVxuICAgIHJldHVyblxuICB9XG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpXG4gIHJldmlld3MuZm9yRWFjaChyZXZpZXcgPT4ge1xuICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSlcbiAgfSlcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHVsKVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSBqcGdhZ2UuXG4gKi9cbmxldCBjcmVhdGVSZXZpZXdIVE1MID0gcmV2aWV3ID0+IHtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhcnRpY2xlJylcbiAgbGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpXG4gIG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWVcbiAgbGkuYXBwZW5kQ2hpbGQobmFtZSlcblxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gIGRhdGUuaW5uZXJIVE1MID0gcmV2aWV3LmRhdGVcbiAgbGkuYXBwZW5kQ2hpbGQoZGF0ZSlcblxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJylcbiAgcmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ31gXG4gIGxpLmFwcGVuZENoaWxkKHJhdGluZylcblxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHNcbiAgbGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpXG5cbiAgcmV0dXJuIGxpXG59XG5cbi8qKlxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcbiAqL1xubGV0IGZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJylcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpXG4gIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZVxuICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKVxufVxuXG4vKipcbiAqIEdldCBhIHBhcmFtZXRlciBieSBuYW1lIGZyb20gcGFnZSBVUkwuXG4gKi9cbmxldCBnZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG4gIGlmICghdXJsKSB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZlxuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJylcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBbPyZdJHtuYW1lfSg9KFteJiNdKil8JnwjfCQpYCksXG4gICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKVxuICBpZiAoIXJlc3VsdHMpIHJldHVybiBudWxsXG4gIGlmICghcmVzdWx0c1syXSkgcmV0dXJuICcnXG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSlcbn1cbiJdfQ==
