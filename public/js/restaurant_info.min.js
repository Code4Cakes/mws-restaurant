"use strict";var restaurant,newMap;document.addEventListener("DOMContentLoaded",function(e){initMap()});var initMap=function(){fetchRestaurantFromURL(function(e,t){e||(document.title="Restaurant Reviews - ".concat(t.name),self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYnJhZHl0Zm9yZCIsImEiOiJjamlydTVnZngwMXlhM3dxbTE2NzNhbWNjIn0.vP54TruwPoPWQLYZdPKcug",maxZoom:18,id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap)),document.querySelector("img.leaflet-marker-icon").setAttribute("aria-label","")})},fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,function(e,n){(self.restaurant=n)&&DBHelper.fetchReviewsByRestaurantId(t,function(e,t){self.restaurant.reviews=t,fillRestaurantHTML(),r(null,n)})}):(error="No restaurant id in URL",r(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("restaurant-name"),n=document.createElement("span"),r=!1===e.is_favorite||"false"===e.is_favorite?"star":"star favorite";n.setAttribute("onclick","toggleFavorite()"),n.setAttribute("class",r),t.innerHTML=e.name,t.append(n),document.getElementById("restaurant-address").innerHTML=e.address;var a=document.getElementById("restaurant-img");a.className="restaurant-img",a.alt=DBHelper.imageAltforRestaurant(e),a.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=n,r.appendChild(a);var i=document.createElement("td");i.innerHTML=e[n],r.appendChild(i),t.appendChild(r)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("div");n.setAttribute("id","titleBox");var r=document.createElement("h2");if(r.innerHTML="Reviews",n.append(r),t.prepend(n),!e){var a=document.createElement("p");return a.innerHTML="No reviews yet!",void n.appendChild(a)}for(var i=document.getElementById("reviews-list");i.firstChild;)i.removeChild(i.firstChild);e.forEach(function(e){i.appendChild(createReviewHTML(e))}),i.appendChild(createForm()),t.appendChild(i)},createReviewHTML=function(e){var t=document.createElement("article");t.setAttribute("tabindex",0);var n=document.createElement("h3");n.innerHTML=e.name,t.appendChild(n);var r=document.createElement("p");r.innerHTML=new Date(e.updatedAt).toLocaleString(),t.appendChild(r);var a=document.createElement("p");a.innerHTML="Rating: ".concat(e.rating),t.appendChild(a);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},createForm=function(){var e=document.createElement("article"),t=document.createElement("h3");t.innerHTML="Missing your favorite spot?",e.append(t);var n=document.createElement("h4");n.innerHTML="Add a restaurant to our listings below.",e.append(n);var r=document.createElement("form");r.setAttribute("action","javascript:void(0)"),r.setAttribute("onsubmit","submitReview()");var a=document.createElement("div"),i=document.createElement("label");i.innerHTML="Your Name",i.setAttribute("for","reviewerName"),a.append(i);var u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("name","reviewerName"),u.setAttribute("id","reviewerName"),u.setAttribute("required","required"),a.append(u),r.append(a);var l=document.createElement("div"),s=document.createElement("label");s.innerHTML="Rating (1-5)",s.setAttribute("for","newReviewRating"),l.append(s);var d=document.createElement("input");d.setAttribute("type","number"),d.setAttribute("min","1"),d.setAttribute("max","5"),d.setAttribute("name","newReviewRating"),d.setAttribute("id","newReviewRating"),d.setAttribute("required","required"),l.append(d),r.append(l);var o=document.createElement("div"),m=document.createElement("label");m.innerHTML="Comments",m.setAttribute("for","newReviewComments"),o.append(m);var c=document.createElement("textarea");c.setAttribute("name","newReviewComments"),c.setAttribute("id","newReviewComments"),c.setAttribute("rows","5"),c.setAttribute("required","required"),o.append(c),r.append(o);var p=document.createElement("button");return p.setAttribute("type","submit"),p.innerHTML="Submit",r.append(p),e.append(r),e},toggleFavorite=function(){var e=document.querySelector(".star");-1!==e.className.indexOf("favorite")?(e.className="star",DBHelper.sendToggleFav(self.restaurant.id,"false")):(e.className="star favorite",DBHelper.sendToggleFav(self.restaurant.id,"true"))},submitReview=function(){var e={id:self.restaurant.reviews.length+1,restaurant_id:self.restaurant.id,name:document.getElementById("reviewerName").value,createdAt:new Date,rating:parseInt(document.getElementById("newReviewRating").value),comments:document.getElementById("newReviewComments").value};DBHelper.addReviews(e),self.restaurant.reviews.push(e),fillReviewsHTML()};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpbml0TWFwIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImVycm9yIiwidGl0bGUiLCJjb25jYXQiLCJuYW1lIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiaWQiLCJhZGRUbyIsImZpbGxCcmVhZGNydW1iIiwiREJIZWxwZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwicXVlcnlTZWxlY3RvciIsInNldEF0dHJpYnV0ZSIsImNhbGxiYWNrIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkIiwicmV2aWV3cyIsImZpbGxSZXN0YXVyYW50SFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImdldEVsZW1lbnRCeUlkIiwic3RhciIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc1N0cmluZyIsImlzX2Zhdm9yaXRlIiwiaW5uZXJIVE1MIiwiYXBwZW5kIiwiYWRkcmVzcyIsImltYWdlIiwiY2xhc3NOYW1lIiwiYWx0IiwiaW1hZ2VBbHRmb3JSZXN0YXVyYW50Iiwic3JjIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwiY3Vpc2luZV90eXBlIiwib3BlcmF0aW5nX2hvdXJzIiwiZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJmaWxsUmV2aWV3c0hUTUwiLCJvcGVyYXRpbmdIb3VycyIsImhvdXJzIiwia2V5Iiwicm93IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwiY29udGFpbmVyIiwidGl0bGVCb3giLCJwcmVwZW5kIiwibm9SZXZpZXdzIiwidWwiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJmb3JFYWNoIiwicmV2aWV3IiwiY3JlYXRlUmV2aWV3SFRNTCIsImNyZWF0ZUZvcm0iLCJsaSIsImRhdGUiLCJEYXRlIiwidXBkYXRlZEF0IiwidG9Mb2NhbGVTdHJpbmciLCJyYXRpbmciLCJjb21tZW50cyIsImJyZWFkY3J1bWIiLCJ1cmwiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJyZXBsYWNlIiwicmVzdWx0cyIsIlJlZ0V4cCIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiLCJhcnRpY2xlIiwiaGVhZGluZyIsInN1YmhlYWRpbmciLCJmb3JtIiwiZGl2MSIsImxhYmVsMSIsImlucHV0MSIsImRpdjIiLCJsYWJlbDIiLCJpbnB1dDIiLCJkaXYzIiwibGFiZWwzIiwiaW5wdXQzIiwiYnV0dG9uIiwidG9nZ2xlRmF2b3JpdGUiLCJ0aGlzU3RhciIsImluZGV4T2YiLCJzZW5kVG9nZ2xlRmF2Iiwic3VibWl0UmV2aWV3IiwicGFyYW1zIiwicmVzdGF1cmFudF9pZCIsInZhbHVlIiwiY3JlYXRlZEF0IiwicGFyc2VJbnQiLCJhZGRSZXZpZXdzIiwicHVzaCJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBSUEsV0FDQUMsT0FLSkMsU0FBU0MsaUJBQWlCLG1CQUFvQixTQUFBQyxHQUM1Q0MsWUFNRixJQUFJQSxRQUFVLFdBQ1pDLHVCQUF1QixTQUFDQyxFQUFPUCxHQUN6Qk8sSUFJRkwsU0FBU00sTUFBVCx3QkFBQUMsT0FBeUNULEVBQVdVLE1BRXBEQyxLQUFLVixPQUFTVyxFQUFFQyxJQUFJLE1BQU8sQ0FDekJDLE9BQVEsQ0FBQ2QsRUFBV2UsT0FBT0MsSUFBS2hCLEVBQVdlLE9BQU9FLEtBQ2xEQyxLQUFNLEdBQ05DLGlCQUFpQixJQUVuQlAsRUFBRVEsVUFDQSxvRkFDQSxDQUNFQyxZQUNFLGdHQUNGQyxRQUFTLEdBQ1RDLEdBQUksbUJBRU5DLE1BQU12QixRQUNSd0IsaUJBQ0FDLFNBQVNDLHVCQUF1QmhCLEtBQUtYLFdBQVlXLEtB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QkFDM0J5RSxFQUFLekQsT0FBTzBELEdBRVosSUFBTUMsRUFBU3RHLFNBQVN1QyxjQUFjLFlBQ3RDK0QsRUFBTzNFLGFBQWEsT0FBUSxxQkFDNUIyRSxFQUFPM0UsYUFBYSxLQUFNLHFCQUMxQjJFLEVBQU8zRSxhQUFhLE9BQVEsS0FDNUIyRSxFQUFPM0UsYUFBYSxXQUFZLFlBQ2hDeUUsRUFBS3pELE9BQU8yRCxHQUVaVCxFQUFLbEQsT0FBT3lELEdBR1osSUFBTUcsRUFBU3ZHLFNBQVN1QyxjQUFjLFVBUXRDLE9BUEFnRSxFQUFPNUUsYUFBYSxPQUFRLFVBQzVCNEUsRUFBTzdELFVBQVksU0FFbkJtRCxFQUFLbEQsT0FBTzRELEdBRVpiLEVBQVEvQyxPQUFPa0QsR0FFUkgsR0FHTGMsZUFBaUIsV0FDbkIsSUFBSUMsRUFBV3pHLFNBQVMwQixjQUFjLFVBQ1UsSUFBNUMrRSxFQUFTM0QsVUFBVTRELFFBQVEsYUFDN0JELEVBQVMzRCxVQUFZLE9BQ3JCdEIsU0FBU21GLGNBQWNsRyxLQUFLWCxXQUFXdUIsR0FBSSxXQUUzQ29GLEVBQVMzRCxVQUFZLGdCQUNyQnRCLFNBQVNtRixjQUFjbEcsS0FBS1gsV0FBV3VCLEdBQUksVUFLM0N1RixhQUFlLFdBQ2pCLElBQUlDLEVBQVMsQ0FDWHhGLEdBQUlaLEtBQUtYLFdBQVdrQyxRQUFRRyxPQUFTLEVBQ3JDMkUsY0FBZXJHLEtBQUtYLFdBQVd1QixHQUMvQmIsS0FBTVIsU0FBU3FDLGVBQWUsZ0JBQWdCMEUsTUFDOUNDLFVBQVcsSUFBSXJDLEtBQ2ZHLE9BQVFtQyxTQUFTakgsU0FBU3FDLGVBQWUsbUJBQW1CMEUsT0FDNURoQyxTQUFVL0UsU0FBU3FDLGVBQWUscUJBQXFCMEUsT0FHekR2RixTQUFTMEYsV0FBV0wsR0FDcEJwRyxLQUFLWCxXQUFXa0MsUUFBUW1GLEtBQUtOLEdBQzdCdkQiLCJmaWxlIjoicmVzdGF1cmFudF9pbmZvLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50XHJcbnZhciBuZXdNYXBcclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIG1hcCBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBldmVudCA9PiB7XHJcbiAgaW5pdE1hcCgpXHJcbn0pXHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBsZWFmbGV0IG1hcFxyXG4gKi9cclxubGV0IGluaXRNYXAgPSAoKSA9PiB7XHJcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIC8vIGNvbnNvbGUuZXJyb3IoZXJyb3IpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkb2N1bWVudC50aXRsZSA9IGBSZXN0YXVyYW50IFJldmlld3MgLSAke3Jlc3RhdXJhbnQubmFtZX1gXHJcblxyXG4gICAgICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XHJcbiAgICAgICAgY2VudGVyOiBbcmVzdGF1cmFudC5sYXRsbmcubGF0LCByZXN0YXVyYW50LmxhdGxuZy5sbmddLFxyXG4gICAgICAgIHpvb206IDE2LFxyXG4gICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2VcclxuICAgICAgfSlcclxuICAgICAgTC50aWxlTGF5ZXIoXHJcbiAgICAgICAgJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgbWFwYm94VG9rZW46XHJcbiAgICAgICAgICAgICdway5leUoxSWpvaVluSmhaSGwwWm05eVpDSXNJbUVpT2lKamFtbHlkVFZuWm5nd01YbGhNM2R4YlRFMk56TmhiV05qSW4wLnZQNTRUcnV3UG9QV1FMWVpkUEtjdWcnLFxyXG4gICAgICAgICAgbWF4Wm9vbTogMTgsXHJcbiAgICAgICAgICBpZDogJ21hcGJveC5zdHJlZXRzJ1xyXG4gICAgICAgIH1cclxuICAgICAgKS5hZGRUbyhuZXdNYXApXHJcbiAgICAgIGZpbGxCcmVhZGNydW1iKClcclxuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubmV3TWFwKVxyXG4gICAgfVxyXG5cclxuICAgIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCdpbWcubGVhZmxldC1tYXJrZXItaWNvbicpXHJcbiAgICAgIC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnJylcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgcmVzdGF1cmFudCBmcm9tIHBhZ2UgVVJMLlxyXG4gKi9cclxubGV0IGZldGNoUmVzdGF1cmFudEZyb21VUkwgPSBjYWxsYmFjayA9PiB7XHJcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkge1xyXG4gICAgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXHJcbiAgICBjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpXHJcbiAgICByZXR1cm5cclxuICB9XHJcbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJylcclxuICBpZiAoIWlkKSB7XHJcbiAgICAvLyBubyBpZCBmb3VuZCBpbiBVUkxcclxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xyXG4gICAgY2FsbGJhY2soZXJyb3IsIG51bGwpXHJcbiAgfSBlbHNlIHtcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgICBzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50XHJcbiAgICAgIGlmICghcmVzdGF1cmFudCkge1xyXG4gICAgICAgIC8vIGNvbnNvbGUuZXJyb3IoZXJyb3IpXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICAgIH1cclxuICAgICAgREJIZWxwZXIuZmV0Y2hSZXZpZXdzQnlSZXN0YXVyYW50SWQoaWQsIChlcnJvciwgcmV2aWV3cykgPT4ge1xyXG4gICAgICAgIHNlbGYucmVzdGF1cmFudC5yZXZpZXdzID0gcmV2aWV3c1xyXG4gICAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpXHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudClcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSBwYWdlXHJcbiAqL1xyXG5sZXQgZmlsbFJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpXHJcbiAgY29uc3Qgc3RhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxyXG4gIFxyXG4gIGNvbnN0IGNsYXNzU3RyaW5nID0gcmVzdGF1cmFudC5pc19mYXZvcml0ZSA9PT0gZmFsc2UgfHwgcmVzdGF1cmFudC5pc19mYXZvcml0ZSA9PT0gJ2ZhbHNlJyAgPyAnc3RhcicgOiAnc3RhciBmYXZvcml0ZSdcclxuXHJcbiAgc3Rhci5zZXRBdHRyaWJ1dGUoJ29uY2xpY2snLCAndG9nZ2xlRmF2b3JpdGUoKScpXHJcbiAgc3Rhci5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgY2xhc3NTdHJpbmcpXHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWVcclxuICBuYW1lLmFwcGVuZChzdGFyKVxyXG5cclxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpXHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3NcclxuXHJcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKVxyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZydcclxuICBpbWFnZS5hbHQgPSBEQkhlbHBlci5pbWFnZUFsdGZvclJlc3RhdXJhbnQocmVzdGF1cmFudClcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudClcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKVxyXG4gIGN1aXNpbmUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5jdWlzaW5lX3R5cGVcclxuXHJcbiAgLy8gZmlsbCBvcGVyYXRpbmcgaG91cnNcclxuICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcclxuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKClcclxuICB9XHJcbiAgLy8gZmlsbCByZXZpZXdzXHJcbiAgZmlsbFJldmlld3NIVE1MKClcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IG9wZXJhdGluZyBob3VycyBIVE1MIHRhYmxlIGFuZCBhZGQgaXQgdG8gdGhlIHBhZ2UuXHJcbiAqL1xyXG5sZXQgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAoXHJcbiAgb3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzXHJcbikgPT4ge1xyXG4gIGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKVxyXG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xyXG4gICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKVxyXG5cclxuICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJylcclxuICAgIGRheS5pbm5lckhUTUwgPSBrZXlcclxuICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpXHJcblxyXG4gICAgY29uc3QgdGltZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJylcclxuICAgIHRpbWUuaW5uZXJIVE1MID0gb3BlcmF0aW5nSG91cnNba2V5XVxyXG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpXHJcblxyXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbGwgcmV2aWV3cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUganBnYWdlLlxyXG4gKi9cclxubGV0IGZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXN0YXVyYW50LnJldmlld3MpID0+IHtcclxuXHJcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJylcclxuICBjb25zdCB0aXRsZUJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXHJcbiAgdGl0bGVCb3guc2V0QXR0cmlidXRlKCdpZCcsICd0aXRsZUJveCcpXHJcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpXHJcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnXHJcbiAgdGl0bGVCb3guYXBwZW5kKHRpdGxlKVxyXG4gIGNvbnRhaW5lci5wcmVwZW5kKHRpdGxlQm94KVxyXG5cclxuICBpZiAoIXJldmlld3MpIHtcclxuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxyXG4gICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnXHJcbiAgICB0aXRsZUJveC5hcHBlbmRDaGlsZChub1Jldmlld3MpXHJcbiAgICByZXR1cm5cclxuICB9XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0JylcclxuICB3aGlsZSAodWwuZmlyc3RDaGlsZCkgdWwucmVtb3ZlQ2hpbGQodWwuZmlyc3RDaGlsZClcclxuICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcclxuICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSlcclxuICB9KVxyXG4gIHVsLmFwcGVuZENoaWxkKGNyZWF0ZUZvcm0oKSlcclxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodWwpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmV2aWV3IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUganBnYWdlLlxyXG4gKi9cclxubGV0IGNyZWF0ZVJldmlld0hUTUwgPSByZXZpZXcgPT4ge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXJ0aWNsZScpXHJcbiAgbGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJylcclxuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lXHJcbiAgbGkuYXBwZW5kQ2hpbGQobmFtZSlcclxuXHJcbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxyXG4gIGRhdGUuaW5uZXJIVE1MID0gbmV3IERhdGUocmV2aWV3LnVwZGF0ZWRBdCkudG9Mb2NhbGVTdHJpbmcoKVxyXG4gIGxpLmFwcGVuZENoaWxkKGRhdGUpXHJcblxyXG4gIGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxyXG4gIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YFxyXG4gIGxpLmFwcGVuZENoaWxkKHJhdGluZylcclxuXHJcbiAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJylcclxuICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHNcclxuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cylcclxuXHJcbiAgcmV0dXJuIGxpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxyXG4gKi9cclxubGV0IGZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBicmVhZGNydW1iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JyZWFkY3J1bWInKVxyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKVxyXG4gIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZVxyXG4gIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxyXG4gKi9cclxubGV0IGdldFBhcmFtZXRlckJ5TmFtZSA9IChuYW1lLCB1cmwpID0+IHtcclxuICBpZiAoIXVybCkgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWZcclxuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJylcclxuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcclxuICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybClcclxuICBpZiAoIXJlc3VsdHMpIHJldHVybiBudWxsXHJcbiAgaWYgKCFyZXN1bHRzWzJdKSByZXR1cm4gJydcclxuICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdHNbMl0ucmVwbGFjZSgvXFwrL2csICcgJykpXHJcbn1cclxuXHJcbi8qKlxyXG4gKkNyZWF0ZSBmb3JtIHRpbGUuXHJcbiAqL1xyXG5sZXQgY3JlYXRlRm9ybSA9ICgpID0+IHtcclxuICBjb25zdCBhcnRpY2xlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXJ0aWNsZScpXHJcblxyXG4gIC8vSGVhZGVyXHJcbiAgY29uc3QgaGVhZGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJylcclxuICBoZWFkaW5nLmlubmVySFRNTCA9ICdNaXNzaW5nIHlvdXIgZmF2b3JpdGUgc3BvdD8nXHJcbiAgYXJ0aWNsZS5hcHBlbmQoaGVhZGluZylcclxuICBjb25zdCBzdWJoZWFkaW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDQnKVxyXG4gIHN1YmhlYWRpbmcuaW5uZXJIVE1MID0gJ0FkZCBhIHJlc3RhdXJhbnQgdG8gb3VyIGxpc3RpbmdzIGJlbG93LidcclxuICBhcnRpY2xlLmFwcGVuZChzdWJoZWFkaW5nKVxyXG5cclxuICAvL0Zvcm1cclxuICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpXHJcbiAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsICdqYXZhc2NyaXB0OnZvaWQoMCknKVxyXG4gIGZvcm0uc2V0QXR0cmlidXRlKCdvbnN1Ym1pdCcsICdzdWJtaXRSZXZpZXcoKScpXHJcblxyXG4gIC8vRmlyc3QgSW5wdXRcclxuICBjb25zdCBkaXYxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuXHJcbiAgY29uc3QgbGFiZWwxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxyXG4gIGxhYmVsMS5pbm5lckhUTUwgPSAnWW91ciBOYW1lJ1xyXG4gIGxhYmVsMS5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdyZXZpZXdlck5hbWUnKVxyXG4gIGRpdjEuYXBwZW5kKGxhYmVsMSlcclxuXHJcbiAgY29uc3QgaW5wdXQxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxyXG4gIGlucHV0MS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpXHJcbiAgaW5wdXQxLnNldEF0dHJpYnV0ZSgnbmFtZScsICdyZXZpZXdlck5hbWUnKVxyXG4gIGlucHV0MS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3Jldmlld2VyTmFtZScpXHJcbiAgaW5wdXQxLnNldEF0dHJpYnV0ZSgncmVxdWlyZWQnLCAncmVxdWlyZWQnKVxyXG4gIGRpdjEuYXBwZW5kKGlucHV0MSlcclxuXHJcbiAgZm9ybS5hcHBlbmQoZGl2MSlcclxuXHJcbiAgLy9TZWNvbmQgSW5wdXRcclxuICBjb25zdCBkaXYyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuXHJcbiAgY29uc3QgbGFiZWwyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxyXG4gIGxhYmVsMi5pbm5lckhUTUwgPSAnUmF0aW5nICgxLTUpJ1xyXG4gIGxhYmVsMi5zZXRBdHRyaWJ1dGUoJ2ZvcicsICduZXdSZXZpZXdSYXRpbmcnKVxyXG4gIGRpdjIuYXBwZW5kKGxhYmVsMilcclxuXHJcbiAgY29uc3QgaW5wdXQyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxyXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnbnVtYmVyJylcclxuICBpbnB1dDIuc2V0QXR0cmlidXRlKCdtaW4nLCAnMScpXHJcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgnbWF4JywgJzUnKVxyXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAnbmV3UmV2aWV3UmF0aW5nJylcclxuICBpbnB1dDIuc2V0QXR0cmlidXRlKCdpZCcsICduZXdSZXZpZXdSYXRpbmcnKVxyXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ3JlcXVpcmVkJywgJ3JlcXVpcmVkJylcclxuICBkaXYyLmFwcGVuZChpbnB1dDIpXHJcblxyXG4gIGZvcm0uYXBwZW5kKGRpdjIpXHJcblxyXG4gIC8vTGFzdCBVc2VyIElucHV0XHJcbiAgY29uc3QgZGl2MyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXHJcblxyXG4gIGNvbnN0IGxhYmVsMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcclxuICBsYWJlbDMuaW5uZXJIVE1MID0gJ0NvbW1lbnRzJ1xyXG4gIGxhYmVsMy5zZXRBdHRyaWJ1dGUoJ2ZvcicsICduZXdSZXZpZXdDb21tZW50cycpXHJcbiAgZGl2My5hcHBlbmQobGFiZWwzKVxyXG5cclxuICBjb25zdCBpbnB1dDMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpXHJcbiAgaW5wdXQzLnNldEF0dHJpYnV0ZSgnbmFtZScsICduZXdSZXZpZXdDb21tZW50cycpXHJcbiAgaW5wdXQzLnNldEF0dHJpYnV0ZSgnaWQnLCAnbmV3UmV2aWV3Q29tbWVudHMnKVxyXG4gIGlucHV0My5zZXRBdHRyaWJ1dGUoJ3Jvd3MnLCAnNScpXHJcbiAgaW5wdXQzLnNldEF0dHJpYnV0ZSgncmVxdWlyZWQnLCAncmVxdWlyZWQnKVxyXG4gIGRpdjMuYXBwZW5kKGlucHV0MylcclxuXHJcbiAgZm9ybS5hcHBlbmQoZGl2MylcclxuXHJcbiAgLy9zdWJtaXQgYnV0dG9uXHJcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcclxuICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ3N1Ym1pdCcpXHJcbiAgYnV0dG9uLmlubmVySFRNTCA9ICdTdWJtaXQnXHJcblxyXG4gIGZvcm0uYXBwZW5kKGJ1dHRvbilcclxuXHJcbiAgYXJ0aWNsZS5hcHBlbmQoZm9ybSlcclxuXHJcbiAgcmV0dXJuIGFydGljbGVcclxufVxyXG5cclxubGV0IHRvZ2dsZUZhdm9yaXRlID0gKCkgPT4ge1xyXG4gIGxldCB0aGlzU3RhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdGFyJylcclxuICBpZiAodGhpc1N0YXIuY2xhc3NOYW1lLmluZGV4T2YoJ2Zhdm9yaXRlJykgIT09IC0xKSB7XHJcbiAgICB0aGlzU3Rhci5jbGFzc05hbWUgPSAnc3RhcidcclxuICAgIERCSGVscGVyLnNlbmRUb2dnbGVGYXYoc2VsZi5yZXN0YXVyYW50LmlkLCAnZmFsc2UnKVxyXG4gIH0gZWxzZSB7XHJcbiAgICB0aGlzU3Rhci5jbGFzc05hbWUgPSAnc3RhciBmYXZvcml0ZSdcclxuICAgIERCSGVscGVyLnNlbmRUb2dnbGVGYXYoc2VsZi5yZXN0YXVyYW50LmlkLCAndHJ1ZScpXHJcbiAgfVxyXG5cclxufVxyXG5cclxubGV0IHN1Ym1pdFJldmlldyA9ICgpID0+IHtcclxuICBsZXQgcGFyYW1zID0ge1xyXG4gICAgaWQ6IHNlbGYucmVzdGF1cmFudC5yZXZpZXdzLmxlbmd0aCArIDEsXHJcbiAgICByZXN0YXVyYW50X2lkOiBzZWxmLnJlc3RhdXJhbnQuaWQsXHJcbiAgICBuYW1lOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3ZXJOYW1lJykudmFsdWUsXHJcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICByYXRpbmc6IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXdSZXZpZXdSYXRpbmcnKS52YWx1ZSksXHJcbiAgICBjb21tZW50czogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ld1Jldmlld0NvbW1lbnRzJykudmFsdWVcclxuICB9XHJcblxyXG4gIERCSGVscGVyLmFkZFJldmlld3MocGFyYW1zKVxyXG4gIHNlbGYucmVzdGF1cmFudC5yZXZpZXdzLnB1c2gocGFyYW1zKVxyXG4gIGZpbGxSZXZpZXdzSFRNTCgpXHJcblxyXG59Il19
