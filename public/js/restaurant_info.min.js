"use strict";var restaurant,newMap;document.addEventListener("DOMContentLoaded",function(e){initMap()});var initMap=function(){fetchRestaurantFromURL(function(e,t){e||(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYnJhZHl0Zm9yZCIsImEiOiJjamlydTVnZngwMXlhM3dxbTE2NzNhbWNjIn0.vP54TruwPoPWQLYZdPKcug",maxZoom:18,id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap)),document.querySelector("img.leaflet-marker-icon").setAttribute("aria-label","")})},fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,function(e,n){(self.restaurant=n)&&DBHelper.fetchReviewsByRestaurantId(t,function(e,t){self.restaurant.reviews=t,fillRestaurantHTML(),r(null,n)})}):(error="No restaurant id in URL",r(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=document.getElementById("restaurant-img");t.className="restaurant-img",t.alt=DBHelper.imageAltforRestaurant(e),t.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=n,r.appendChild(a);var i=document.createElement("td");i.innerHTML=e[n],r.appendChild(i),t.appendChild(r)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("div");n.setAttribute("id","titleBox");var r=document.createElement("h2");if(r.innerHTML="Reviews",n.append(r),t.prepend(n),!e){var a=document.createElement("p");return a.innerHTML="No reviews yet!",void n.appendChild(a)}var i=document.getElementById("reviews-list");e.forEach(function(e){i.appendChild(createReviewHTML(e))}),i.appendChild(createForm()),t.appendChild(i)},createReviewHTML=function(e){var t=document.createElement("article");t.setAttribute("tabindex",0);var n=document.createElement("h3");n.innerHTML=e.name,t.appendChild(n);var r=document.createElement("p");r.innerHTML=new Date(e.updatedAt).toLocaleString(),t.appendChild(r);var a=document.createElement("p");a.innerHTML="Rating: ".concat(e.rating),t.appendChild(a);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},createForm=function(){var e=document.createElement("article"),t=document.createElement("h2");t.innerHTML="Missing your favorite spot?",e.append(t);var n=document.createElement("h3");n.innerHTML="Add a restaurant to our listings below.",e.append(n);var r=document.createElement("form");r.setAttribute("action","javascript:void(0)"),r.setAttribute("onsubmit","submitEntry(this)");var a=document.createElement("div"),i=document.createElement("label");i.innerHTML="Your Name",i.setAttribute("for","reviewerName"),a.append(i);var l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("name","reviewerName"),l.setAttribute("id","reviewerName"),a.append(l),e.append(a);var m=document.createElement("div"),u=document.createElement("label");u.innerHTML="Rating (1-5)",u.setAttribute("for","newPlaceRating"),m.append(u);var o=document.createElement("input");o.setAttribute("type","number"),o.setAttribute("min","1"),o.setAttribute("max","5"),o.setAttribute("name","newPlaceRating"),o.setAttribute("id","newPlaceRating"),m.append(o),e.append(m);var d=document.createElement("div"),c=document.createElement("label");c.innerHTML="Comments",c.setAttribute("for","newPlaceComments"),d.append(c);var s=document.createElement("textarea");s.setAttribute("name","newPlaceComments"),s.setAttribute("id","newPlaceComments"),s.setAttribute("rows","5"),d.append(s),e.append(d);var p=document.createElement("button");return p.setAttribute("type","submit"),p.innerHTML="Submit",e.append(p),e.append(r),e};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpbml0TWFwIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImVycm9yIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiaWQiLCJhZGRUbyIsImZpbGxCcmVhZGNydW1iIiwiREJIZWxwZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwicXVlcnlTZWxlY3RvciIsInNldEF0dHJpYnV0ZSIsImNhbGxiYWNrIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkIiwicmV2aWV3TGlzdCIsInJldmlld3MiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsIm5hbWUiLCJhZGRyZXNzIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJhbHQiLCJpbWFnZUFsdGZvclJlc3RhdXJhbnQiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJjdWlzaW5lX3R5cGUiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZpbGxSZXZpZXdzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiaG91cnMiLCJrZXkiLCJyb3ciLCJjcmVhdGVFbGVtZW50IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwiY29udGFpbmVyIiwidGl0bGVCb3giLCJ0aXRsZSIsImFwcGVuZCIsInByZXBlbmQiLCJub1Jldmlld3MiLCJ1bCIsImZvckVhY2giLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwiY3JlYXRlRm9ybSIsImxpIiwiZGF0ZSIsIkRhdGUiLCJ1cGRhdGVkQXQiLCJ0b0xvY2FsZVN0cmluZyIsInJhdGluZyIsImNvbmNhdCIsImNvbW1lbnRzIiwiYnJlYWRjcnVtYiIsInVybCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsInJlcGxhY2UiLCJyZXN1bHRzIiwiUmVnRXhwIiwiZXhlYyIsImRlY29kZVVSSUNvbXBvbmVudCIsImFydGljbGUiLCJoZWFkaW5nIiwic3ViaGVhZGluZyIsImZvcm0iLCJkaXYxIiwibGFiZWwxIiwiaW5wdXQxIiwiZGl2MiIsImxhYmVsMiIsImlucHV0MiIsImRpdjMiLCJsYWJlbDMiLCJpbnB1dDMiLCJidXR0b24iXSwibWFwcGluZ3MiOiJhQUFBLElBQUlBLFdBQ0FDLE9BS0pDLFNBQVNDLGlCQUFpQixtQkFBb0IsU0FBQUMsR0FDNUNDLFlBTUYsSUFBSUEsUUFBVSxXQUNaQyx1QkFBdUIsU0FBQ0MsRUFBT1AsR0FDekJPLElBSUZDLEtBQUtQLE9BQVNRLEVBQUVDLElBQUksTUFBTyxDQUN6QkMsT0FBUSxDQUFDWCxFQUFXWSxPQUFPQyxJQUFLYixFQUFXWSxPQUFPRSxLQUNsREMsS0FBTSxHQUNOQyxpQkFBaUIsSUFFbkJQLEVBQUVRLFVBQ0Esb0ZBQ0EsQ0FDRUMsWUFDRSxnR0FDRkMsUUFBUyxHQUNUQyxHQUFJLG1CQUVOQyxNQUFNcEIsUUFDUnFCLGlCQUNBQyxTQUFTQyx1QkFBdUJoQixLQUFLUixXQUFZUSxLQUFLUCxTQUd4REMsU0FDR3VCLGNBQWMsMkJBQ2RDLGFBQWEsYUFBYyxPQU85QnBCLHVCQUF5QixTQUFBcUIsR0FDM0IsR0FBSW5CLEtBQUtSLFdBRVAyQixFQUFTLEtBQU1uQixLQUFLUixnQkFGdEIsQ0FLQSxJQUFNb0IsRUFBS1EsbUJBQW1CLE1BQ3pCUixFQUtIRyxTQUFTTSxvQkFBb0JULEVBQUksU0FBQ2IsRUFBT1AsSUFDdkNRLEtBQUtSLFdBQWFBLElBS2xCdUIsU0FBU08sMkJBQTJCVixFQUFJLFNBQUNi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QyxFQUFTOUYsU0FBU3FELGNBQWMsU0FDdEN5QyxFQUFPMUQsVUFBWSxlQUNuQjBELEVBQU90RSxhQUFhLE1BQU8sa0JBQzNCcUUsRUFBS2pDLE9BQU9rQyxHQUVaLElBQU1DLEVBQVMvRixTQUFTcUQsY0FBYyxTQUN0QzBDLEVBQU92RSxhQUFhLE9BQVEsVUFDNUJ1RSxFQUFPdkUsYUFBYSxNQUFPLEtBQzNCdUUsRUFBT3ZFLGFBQWEsTUFBTyxLQUMzQnVFLEVBQU92RSxhQUFhLE9BQVEsa0JBQzVCdUUsRUFBT3ZFLGFBQWEsS0FBTSxrQkFDMUJxRSxFQUFLakMsT0FBT21DLEdBRVpULEVBQVExQixPQUFPaUMsR0FHZixJQUFNRyxFQUFPaEcsU0FBU3FELGNBQWMsT0FFOUI0QyxFQUFTakcsU0FBU3FELGNBQWMsU0FDdEM0QyxFQUFPN0QsVUFBWSxXQUNuQjZELEVBQU96RSxhQUFhLE1BQU8sb0JBQzNCd0UsRUFBS3BDLE9BQU9xQyxHQUVaLElBQU1DLEVBQVNsRyxTQUFTcUQsY0FBYyxZQUN0QzZDLEVBQU8xRSxhQUFhLE9BQVEsb0JBQzVCMEUsRUFBTzFFLGFBQWEsS0FBTSxvQkFDMUIwRSxFQUFPMUUsYUFBYSxPQUFRLEtBQzVCd0UsRUFBS3BDLE9BQU9zQyxHQUVaWixFQUFRMUIsT0FBT29DLEdBR2YsSUFBTUcsRUFBU25HLFNBQVNxRCxjQUFjLFVBUXRDLE9BUEE4QyxFQUFPM0UsYUFBYSxPQUFRLFVBQzVCMkUsRUFBTy9ELFVBQVksU0FFbkJrRCxFQUFRMUIsT0FBT3VDLEdBRWZiLEVBQVExQixPQUFPNkIsR0FFUkgiLCJmaWxlIjoicmVzdGF1cmFudF9pbmZvLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50XG52YXIgbmV3TWFwXG5cbi8qKlxuICogSW5pdGlhbGl6ZSBtYXAgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBldmVudCA9PiB7XG4gIGluaXRNYXAoKVxufSlcblxuLyoqXG4gKiBJbml0aWFsaXplIGxlYWZsZXQgbWFwXG4gKi9cbmxldCBpbml0TWFwID0gKCkgPT4ge1xuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgLy8gR290IGFuIGVycm9yIVxuICAgICAgLy8gY29uc29sZS5lcnJvcihlcnJvcilcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZi5uZXdNYXAgPSBMLm1hcCgnbWFwJywge1xuICAgICAgICBjZW50ZXI6IFtyZXN0YXVyYW50LmxhdGxuZy5sYXQsIHJlc3RhdXJhbnQubGF0bG5nLmxuZ10sXG4gICAgICAgIHpvb206IDE2LFxuICAgICAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXG4gICAgICB9KVxuICAgICAgTC50aWxlTGF5ZXIoXG4gICAgICAgICdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLFxuICAgICAgICB7XG4gICAgICAgICAgbWFwYm94VG9rZW46XG4gICAgICAgICAgICAncGsuZXlKMUlqb2lZbkpoWkhsMFptOXlaQ0lzSW1FaU9pSmphbWx5ZFRWblpuZ3dNWGxoTTNkeGJURTJOek5oYldOakluMC52UDU0VHJ1d1BvUFdRTFlaZFBLY3VnJyxcbiAgICAgICAgICBtYXhab29tOiAxOCxcbiAgICAgICAgICBpZDogJ21hcGJveC5zdHJlZXRzJ1xuICAgICAgICB9XG4gICAgICApLmFkZFRvKG5ld01hcClcbiAgICAgIGZpbGxCcmVhZGNydW1iKClcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBzZWxmLm5ld01hcClcbiAgICB9XG5cbiAgICBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJ2ltZy5sZWFmbGV0LW1hcmtlci1pY29uJylcbiAgICAgIC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnJylcbiAgfSlcbn1cblxuLyoqXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXG4gKi9cbmxldCBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gY2FsbGJhY2sgPT4ge1xuICBpZiAoc2VsZi5yZXN0YXVyYW50KSB7XG4gICAgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KVxuICAgIHJldHVyblxuICB9XG4gIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpXG4gIGlmICghaWQpIHtcbiAgICAvLyBubyBpZCBmb3VuZCBpbiBVUkxcbiAgICBlcnJvciA9ICdObyByZXN0YXVyYW50IGlkIGluIFVSTCdcbiAgICBjYWxsYmFjayhlcnJvciwgbnVsbClcbiAgfSBlbHNlIHtcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICAgIHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnRcbiAgICAgIGlmICghcmVzdGF1cmFudCkge1xuICAgICAgICAvLyBjb25zb2xlLmVycm9yKGVycm9yKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIERCSGVscGVyLmZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkKGlkLCAoZXJyb3IsIHJldmlld0xpc3QpID0+IHtcbiAgICAgICAgc2VsZi5yZXN0YXVyYW50LnJldmlld3MgPSByZXZpZXdMaXN0XG4gICAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpXG4gICAgICB9KVxuICAgIH0pXG4gIH0gICBcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIGpwZ2FnZVxuICovXG5sZXQgZmlsbFJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKVxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZVxuXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJylcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3NcblxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWltZycpXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZydcbiAgaW1hZ2UuYWx0ID0gREJIZWxwZXIuaW1hZ2VBbHRmb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpXG4gIGltYWdlLnNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KVxuXG4gIGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1jdWlzaW5lJylcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZVxuXG4gIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKClcbiAgfVxuICAvLyBmaWxsIHJldmlld3NcbiAgZmlsbFJldmlld3NIVE1MKClcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSBwYWdlLlxuICovXG5sZXQgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAoXG4gIG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vyc1xuKSA9PiB7XG4gIGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKVxuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpXG5cbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpXG4gICAgZGF5LmlubmVySFRNTCA9IGtleVxuICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpXG5cbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKVxuICAgIHRpbWUuaW5uZXJIVE1MID0gb3BlcmF0aW5nSG91cnNba2V5XVxuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKVxuXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSBqcGdhZ2UuXG4gKi9cbmxldCBmaWxsUmV2aWV3c0hUTUwgPSAocmV2aWV3cyA9IHNlbGYucmVzdGF1cmFudC5yZXZpZXdzKSA9PiB7XG5cbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJylcbiAgY29uc3QgdGl0bGVCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICB0aXRsZUJveC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3RpdGxlQm94JylcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpXG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJ1xuICB0aXRsZUJveC5hcHBlbmQodGl0bGUpXG4gIGNvbnRhaW5lci5wcmVwZW5kKHRpdGxlQm94KVxuXG4gIGlmICghcmV2aWV3cykge1xuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJ1xuICAgIHRpdGxlQm94LmFwcGVuZENoaWxkKG5vUmV2aWV3cylcbiAgICByZXR1cm5cbiAgfVxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKVxuICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcbiAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpXG4gIH0pXG4gIHVsLmFwcGVuZENoaWxkKGNyZWF0ZUZvcm0oKSlcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHVsKVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSBqcGdhZ2UuXG4gKi9cbmxldCBjcmVhdGVSZXZpZXdIVE1MID0gcmV2aWV3ID0+IHtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhcnRpY2xlJylcbiAgbGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpXG4gIG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWVcbiAgbGkuYXBwZW5kQ2hpbGQobmFtZSlcblxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gIGRhdGUuaW5uZXJIVE1MID0gbmV3IERhdGUocmV2aWV3LnVwZGF0ZWRBdCkudG9Mb2NhbGVTdHJpbmcoKVxuICBsaS5hcHBlbmRDaGlsZChkYXRlKVxuXG4gIGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWBcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKVxuXG4gIGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50c1xuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cylcblxuICByZXR1cm4gbGlcbn1cblxuLyoqXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxuICovXG5sZXQgZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBicmVhZGNydW1iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JyZWFkY3J1bWInKVxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJylcbiAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lXG4gIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpXG59XG5cbi8qKlxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cbiAqL1xubGV0IGdldFBhcmFtZXRlckJ5TmFtZSA9IChuYW1lLCB1cmwpID0+IHtcbiAgaWYgKCF1cmwpIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmXG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKVxuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpXG4gIGlmICghcmVzdWx0cykgcmV0dXJuIG51bGxcbiAgaWYgKCFyZXN1bHRzWzJdKSByZXR1cm4gJydcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKVxufVxuXG5sZXQgY3JlYXRlRm9ybSA9ICgpID0+IHtcbiAgY29uc3QgYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKVxuXG4gIC8vSGVhZGVyXG4gIGNvbnN0IGhlYWRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpXG4gIGhlYWRpbmcuaW5uZXJIVE1MID0gJ01pc3NpbmcgeW91ciBmYXZvcml0ZSBzcG90PydcbiAgYXJ0aWNsZS5hcHBlbmQoaGVhZGluZylcbiAgY29uc3Qgc3ViaGVhZGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJylcbiAgc3ViaGVhZGluZy5pbm5lckhUTUwgPSAnQWRkIGEgcmVzdGF1cmFudCB0byBvdXIgbGlzdGluZ3MgYmVsb3cuJ1xuICBhcnRpY2xlLmFwcGVuZChzdWJoZWFkaW5nKVxuXG4gIC8vRm9ybVxuICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpXG4gIGZvcm0uc2V0QXR0cmlidXRlKCdhY3Rpb24nLCAnamF2YXNjcmlwdDp2b2lkKDApJylcbiAgZm9ybS5zZXRBdHRyaWJ1dGUoJ29uc3VibWl0JywgJ3N1Ym1pdEVudHJ5KHRoaXMpJylcblxuICAvL0ZpcnN0IElucHV0XG4gIGNvbnN0IGRpdjEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gIGNvbnN0IGxhYmVsMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcbiAgbGFiZWwxLmlubmVySFRNTCA9ICdZb3VyIE5hbWUnXG4gIGxhYmVsMS5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdyZXZpZXdlck5hbWUnKVxuICBkaXYxLmFwcGVuZChsYWJlbDEpXG5cbiAgY29uc3QgaW5wdXQxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxuICBpbnB1dDEuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKVxuICBpbnB1dDEuc2V0QXR0cmlidXRlKCduYW1lJywgJ3Jldmlld2VyTmFtZScpXG4gIGlucHV0MS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3Jldmlld2VyTmFtZScpXG4gIGRpdjEuYXBwZW5kKGlucHV0MSlcblxuICBhcnRpY2xlLmFwcGVuZChkaXYxKVxuXG4gIC8vU2Vjb25kIElucHV0XG4gIGNvbnN0IGRpdjIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gIGNvbnN0IGxhYmVsMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcbiAgbGFiZWwyLmlubmVySFRNTCA9ICdSYXRpbmcgKDEtNSknXG4gIGxhYmVsMi5zZXRBdHRyaWJ1dGUoJ2ZvcicsICduZXdQbGFjZVJhdGluZycpXG4gIGRpdjIuYXBwZW5kKGxhYmVsMilcblxuICBjb25zdCBpbnB1dDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnbnVtYmVyJylcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgnbWluJywgJzEnKVxuICBpbnB1dDIuc2V0QXR0cmlidXRlKCdtYXgnLCAnNScpXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAnbmV3UGxhY2VSYXRpbmcnKVxuICBpbnB1dDIuc2V0QXR0cmlidXRlKCdpZCcsICduZXdQbGFjZVJhdGluZycpXG4gIGRpdjIuYXBwZW5kKGlucHV0MilcblxuICBhcnRpY2xlLmFwcGVuZChkaXYyKVxuXG4gIC8vTGFzdCBVc2VyIElucHV0XG4gIGNvbnN0IGRpdjMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gIGNvbnN0IGxhYmVsMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcbiAgbGFiZWwzLmlubmVySFRNTCA9ICdDb21tZW50cydcbiAgbGFiZWwzLnNldEF0dHJpYnV0ZSgnZm9yJywgJ25ld1BsYWNlQ29tbWVudHMnKVxuICBkaXYzLmFwcGVuZChsYWJlbDMpXG5cbiAgY29uc3QgaW5wdXQzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKVxuICBpbnB1dDMuc2V0QXR0cmlidXRlKCduYW1lJywgJ25ld1BsYWNlQ29tbWVudHMnKVxuICBpbnB1dDMuc2V0QXR0cmlidXRlKCdpZCcsICduZXdQbGFjZUNvbW1lbnRzJylcbiAgaW5wdXQzLnNldEF0dHJpYnV0ZSgncm93cycsICc1JylcbiAgZGl2My5hcHBlbmQoaW5wdXQzKVxuXG4gIGFydGljbGUuYXBwZW5kKGRpdjMpXG5cbiAgLy9zdWJtaXQgYnV0dG9uXG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnc3VibWl0JylcbiAgYnV0dG9uLmlubmVySFRNTCA9ICdTdWJtaXQnXG5cbiAgYXJ0aWNsZS5hcHBlbmQoYnV0dG9uKVxuXG4gIGFydGljbGUuYXBwZW5kKGZvcm0pXG5cbiAgcmV0dXJuIGFydGljbGVcbn1cbiJdfQ==
