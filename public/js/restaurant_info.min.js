"use strict";var restaurant,newMap;document.addEventListener("DOMContentLoaded",function(e){initMap()});var initMap=function(){fetchRestaurantFromURL(function(e,t){e||(document.title="Restaurant Reviews - ".concat(t.name),self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYnJhZHl0Zm9yZCIsImEiOiJjamlydTVnZngwMXlhM3dxbTE2NzNhbWNjIn0.vP54TruwPoPWQLYZdPKcug",maxZoom:18,id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap)),document.querySelector("img.leaflet-marker-icon").setAttribute("aria-label","")})},fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,function(e,n){(self.restaurant=n)&&DBHelper.fetchReviewsByRestaurantId(t,function(e,t){self.restaurant.reviews=t,fillRestaurantHTML(),r(null,n)})}):(error="No restaurant id in URL",r(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("restaurant-name"),n=document.createElement("span"),r=!1===e.is_favorite||"false"===e.is_favorite?"star":"star favorite";n.setAttribute("onclick","toggleFavorite()"),n.setAttribute("class",r),t.innerHTML=e.name,t.append(n),document.getElementById("restaurant-address").innerHTML=e.address;var a=document.getElementById("restaurant-img");a.className="restaurant-img",a.alt=DBHelper.imageAltforRestaurant(e),a.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=n,r.appendChild(a);var i=document.createElement("td");i.innerHTML=e[n],r.appendChild(i),t.appendChild(r)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("div");n.setAttribute("id","titleBox");var r=document.createElement("h2");if(r.innerHTML="Reviews",n.append(r),t.prepend(n),!e){var a=document.createElement("p");return a.innerHTML="No reviews yet!",void n.appendChild(a)}for(var i=document.getElementById("reviews-list");i.firstChild;)i.removeChild(i.firstChild);e.forEach(function(e){i.appendChild(createReviewHTML(e))}),i.appendChild(createForm()),t.appendChild(i)},createReviewHTML=function(e){var t=document.createElement("article");t.setAttribute("tabindex",0);var n=document.createElement("h3");n.innerHTML=e.name,t.appendChild(n);var r=document.createElement("p");r.innerHTML=new Date(e.updatedAt).toLocaleString(),t.appendChild(r);var a=document.createElement("p");a.innerHTML="Rating: ".concat(e.rating),t.appendChild(a);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},createForm=function(){var e=document.createElement("article"),t=document.createElement("h3");t.innerHTML="Have an opinion?",e.append(t);var n=document.createElement("h4");n.innerHTML="Let us know what you think.",e.append(n);var r=document.createElement("form");r.setAttribute("action","javascript:void(0)"),r.setAttribute("onsubmit","submitReview()");var a=document.createElement("div"),i=document.createElement("label");i.innerHTML="Your Name",i.setAttribute("for","reviewerName"),a.append(i);var u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("name","reviewerName"),u.setAttribute("id","reviewerName"),u.setAttribute("required","required"),a.append(u),r.append(a);var l=document.createElement("div"),d=document.createElement("label");d.innerHTML="Rating (1-5)",d.setAttribute("for","newReviewRating"),l.append(d);var o=document.createElement("input");o.setAttribute("type","number"),o.setAttribute("min","1"),o.setAttribute("max","5"),o.setAttribute("name","newReviewRating"),o.setAttribute("id","newReviewRating"),o.setAttribute("required","required"),l.append(o),r.append(l);var m=document.createElement("div"),s=document.createElement("label");s.innerHTML="Comments",s.setAttribute("for","newReviewComments"),m.append(s);var c=document.createElement("textarea");c.setAttribute("name","newReviewComments"),c.setAttribute("id","newReviewComments"),c.setAttribute("rows","5"),c.setAttribute("required","required"),m.append(c),r.append(m);var p=document.createElement("button");return p.setAttribute("type","submit"),p.innerHTML="Submit",r.append(p),e.append(r),e},toggleFavorite=function(){var e=document.querySelector(".star");-1!==e.className.indexOf("favorite")?(e.className="star",DBHelper.sendToggleFav(self.restaurant.id,"false")):(e.className="star favorite",DBHelper.sendToggleFav(self.restaurant.id,"true"))},submitReview=function(){var e={id:self.restaurant.reviews.length+1,restaurant_id:self.restaurant.id,name:document.getElementById("reviewerName").value,createdAt:Date.now(),updatedAt:Date.now(),rating:parseInt(document.getElementById("newReviewRating").value),comments:document.getElementById("newReviewComments").value};DBHelper.addReview(e),self.restaurant.reviews.push(e),fillReviewsHTML()};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpbml0TWFwIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImVycm9yIiwidGl0bGUiLCJjb25jYXQiLCJuYW1lIiwic2VsZiIsIkwiLCJtYXAiLCJjZW50ZXIiLCJsYXRsbmciLCJsYXQiLCJsbmciLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiaWQiLCJhZGRUbyIsImZpbGxCcmVhZGNydW1iIiwiREJIZWxwZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwicXVlcnlTZWxlY3RvciIsInNldEF0dHJpYnV0ZSIsImNhbGxiYWNrIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkIiwicmV2aWV3cyIsImZpbGxSZXN0YXVyYW50SFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImdldEVsZW1lbnRCeUlkIiwic3RhciIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc1N0cmluZyIsImlzX2Zhdm9yaXRlIiwiaW5uZXJIVE1MIiwiYXBwZW5kIiwiYWRkcmVzcyIsImltYWdlIiwiY2xhc3NOYW1lIiwiYWx0IiwiaW1hZ2VBbHRmb3JSZXN0YXVyYW50Iiwic3JjIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwiY3Vpc2luZV90eXBlIiwib3BlcmF0aW5nX2hvdXJzIiwiZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJmaWxsUmV2aWV3c0hUTUwiLCJvcGVyYXRpbmdIb3VycyIsImhvdXJzIiwia2V5Iiwicm93IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwiY29udGFpbmVyIiwidGl0bGVCb3giLCJwcmVwZW5kIiwibm9SZXZpZXdzIiwidWwiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJmb3JFYWNoIiwicmV2aWV3IiwiY3JlYXRlUmV2aWV3SFRNTCIsImNyZWF0ZUZvcm0iLCJsaSIsImRhdGUiLCJEYXRlIiwidXBkYXRlZEF0IiwidG9Mb2NhbGVTdHJpbmciLCJyYXRpbmciLCJjb21tZW50cyIsImJyZWFkY3J1bWIiLCJ1cmwiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJyZXBsYWNlIiwicmVzdWx0cyIsIlJlZ0V4cCIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiLCJhcnRpY2xlIiwiaGVhZGluZyIsInN1YmhlYWRpbmciLCJmb3JtIiwiZGl2MSIsImxhYmVsMSIsImlucHV0MSIsImRpdjIiLCJsYWJlbDIiLCJpbnB1dDIiLCJkaXYzIiwibGFiZWwzIiwiaW5wdXQzIiwiYnV0dG9uIiwidG9nZ2xlRmF2b3JpdGUiLCJ0aGlzU3RhciIsImluZGV4T2YiLCJzZW5kVG9nZ2xlRmF2Iiwic3VibWl0UmV2aWV3IiwicGFyYW1zIiwicmVzdGF1cmFudF9pZCIsInZhbHVlIiwiY3JlYXRlZEF0Iiwibm93IiwicGFyc2VJbnQiLCJhZGRSZXZpZXciLCJwdXNoIl0sIm1hcHBpbmdzIjoiYUFBQSxJQUFJQSxXQUNBQyxPQUtKQyxTQUFTQyxpQkFBaUIsbUJBQW9CLFNBQUFDLEdBQzVDQyxZQU1GLElBQUlBLFFBQVUsV0FDWkMsdUJBQXVCLFNBQUNDLEVBQU9QLEdBQ3pCTyxJQUlGTCxTQUFTTSxNQUFULHdCQUFBQyxPQUF5Q1QsRUFBV1UsTUFFcERDLEtBQUtWLE9BQVNXLEVBQUVDLElBQUksTUFBTyxDQUN6QkMsT0FBUSxDQUFDZCxFQUFXZSxPQUFPQyxJQUFLaEIsRUFBV2UsT0FBT0UsS0FDbERDLEtBQU0sR0FDTkMsaUJBQWlCLElBRW5CUCxFQUFFUSxVQUNBLG9GQUNBLENBQ0VDLFlBQ0UsZ0dBQ0ZDLFFBQVMsR0FDVEMsR0FBSSxtQkFFTkMsTUFBTXZCLFFBQ1J3QixpQkFDQUMsU0FBU0MsdUJBQXVCaEIsS0FBS1gsV0FB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YW50XHJcbnZhciBuZXdNYXBcclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIG1hcCBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBldmVudCA9PiB7XHJcbiAgaW5pdE1hcCgpXHJcbn0pXHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBsZWFmbGV0IG1hcFxyXG4gKi9cclxubGV0IGluaXRNYXAgPSAoKSA9PiB7XHJcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIC8vIGNvbnNvbGUuZXJyb3IoZXJyb3IpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkb2N1bWVudC50aXRsZSA9IGBSZXN0YXVyYW50IFJldmlld3MgLSAke3Jlc3RhdXJhbnQubmFtZX1gXHJcblxyXG4gICAgICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XHJcbiAgICAgICAgY2VudGVyOiBbcmVzdGF1cmFudC5sYXRsbmcubGF0LCByZXN0YXVyYW50LmxhdGxuZy5sbmddLFxyXG4gICAgICAgIHpvb206IDE2LFxyXG4gICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2VcclxuICAgICAgfSlcclxuICAgICAgTC50aWxlTGF5ZXIoXHJcbiAgICAgICAgJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgbWFwYm94VG9rZW46XHJcbiAgICAgICAgICAgICdway5leUoxSWpvaVluSmhaSGwwWm05eVpDSXNJbUVpT2lKamFtbHlkVFZuWm5nd01YbGhNM2R4YlRFMk56TmhiV05qSW4wLnZQNTRUcnV3UG9QV1FMWVpkUEtjdWcnLFxyXG4gICAgICAgICAgbWF4Wm9vbTogMTgsXHJcbiAgICAgICAgICBpZDogJ21hcGJveC5zdHJlZXRzJ1xyXG4gICAgICAgIH1cclxuICAgICAgKS5hZGRUbyhuZXdNYXApXHJcbiAgICAgIGZpbGxCcmVhZGNydW1iKClcclxuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubmV3TWFwKVxyXG4gICAgfVxyXG5cclxuICAgIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCdpbWcubGVhZmxldC1tYXJrZXItaWNvbicpXHJcbiAgICAgIC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnJylcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgcmVzdGF1cmFudCBmcm9tIHBhZ2UgVVJMLlxyXG4gKi9cclxubGV0IGZldGNoUmVzdGF1cmFudEZyb21VUkwgPSBjYWxsYmFjayA9PiB7XHJcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkge1xyXG4gICAgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXHJcbiAgICBjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpXHJcbiAgICByZXR1cm5cclxuICB9XHJcbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJylcclxuICBpZiAoIWlkKSB7XHJcbiAgICAvLyBubyBpZCBmb3VuZCBpbiBVUkxcclxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xyXG4gICAgY2FsbGJhY2soZXJyb3IsIG51bGwpXHJcbiAgfSBlbHNlIHtcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgICBzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50XHJcbiAgICAgIGlmICghcmVzdGF1cmFudCkge1xyXG4gICAgICAgIC8vIGNvbnNvbGUuZXJyb3IoZXJyb3IpXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICAgIH1cclxuICAgICAgREJIZWxwZXIuZmV0Y2hSZXZpZXdzQnlSZXN0YXVyYW50SWQoaWQsIChlcnJvciwgcmV2aWV3cykgPT4ge1xyXG4gICAgICAgIHNlbGYucmVzdGF1cmFudC5yZXZpZXdzID0gcmV2aWV3c1xyXG4gICAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpXHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudClcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSBwYWdlXHJcbiAqL1xyXG5sZXQgZmlsbFJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpXHJcbiAgY29uc3Qgc3RhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxyXG5cclxuICBjb25zdCBjbGFzc1N0cmluZyA9IHJlc3RhdXJhbnQuaXNfZmF2b3JpdGUgPT09IGZhbHNlIHx8IHJlc3RhdXJhbnQuaXNfZmF2b3JpdGUgPT09ICdmYWxzZScgID8gJ3N0YXInIDogJ3N0YXIgZmF2b3JpdGUnXHJcblxyXG4gIHN0YXIuc2V0QXR0cmlidXRlKCdvbmNsaWNrJywgJ3RvZ2dsZUZhdm9yaXRlKCknKVxyXG4gIHN0YXIuc2V0QXR0cmlidXRlKCdjbGFzcycsIGNsYXNzU3RyaW5nKVxyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lXHJcbiAgbmFtZS5hcHBlbmQoc3RhcilcclxuXHJcbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWFkZHJlc3MnKVxyXG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzXHJcblxyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJylcclxuICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnXHJcbiAgaW1hZ2UuYWx0ID0gREJIZWxwZXIuaW1hZ2VBbHRmb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpXHJcbiAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpXHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1jdWlzaW5lJylcclxuICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlXHJcblxyXG4gIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXHJcbiAgaWYgKHJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSB7XHJcbiAgICBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpXHJcbiAgfVxyXG4gIC8vIGZpbGwgcmV2aWV3c1xyXG4gIGZpbGxSZXZpZXdzSFRNTCgpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSBwYWdlLlxyXG4gKi9cclxubGV0IGZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKFxyXG4gIG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vyc1xyXG4pID0+IHtcclxuICBjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJylcclxuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcclxuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJylcclxuXHJcbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpXHJcbiAgICBkYXkuaW5uZXJIVE1MID0ga2V5XHJcbiAgICByb3cuYXBwZW5kQ2hpbGQoZGF5KVxyXG5cclxuICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpXHJcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV1cclxuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKVxyXG5cclxuICAgIGhvdXJzLmFwcGVuZENoaWxkKHJvdylcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIGpwZ2FnZS5cclxuICovXHJcbmxldCBmaWxsUmV2aWV3c0hUTUwgPSAocmV2aWV3cyA9IHNlbGYucmVzdGF1cmFudC5yZXZpZXdzKSA9PiB7XHJcblxyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWNvbnRhaW5lcicpXHJcbiAgY29uc3QgdGl0bGVCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG4gIHRpdGxlQm94LnNldEF0dHJpYnV0ZSgnaWQnLCAndGl0bGVCb3gnKVxyXG4gIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKVxyXG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJ1xyXG4gIHRpdGxlQm94LmFwcGVuZCh0aXRsZSlcclxuICBjb250YWluZXIucHJlcGVuZCh0aXRsZUJveClcclxuXHJcbiAgaWYgKCFyZXZpZXdzKSB7XHJcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJylcclxuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJ1xyXG4gICAgdGl0bGVCb3guYXBwZW5kQ2hpbGQobm9SZXZpZXdzKVxyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpXHJcbiAgd2hpbGUgKHVsLmZpcnN0Q2hpbGQpIHVsLnJlbW92ZUNoaWxkKHVsLmZpcnN0Q2hpbGQpXHJcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XHJcbiAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpXHJcbiAgfSlcclxuICB1bC5hcHBlbmRDaGlsZChjcmVhdGVGb3JtKCkpXHJcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHVsKVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIGpwZ2FnZS5cclxuICovXHJcbmxldCBjcmVhdGVSZXZpZXdIVE1MID0gcmV2aWV3ID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKVxyXG4gIGxpLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKVxyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpXHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXZpZXcubmFtZVxyXG4gIGxpLmFwcGVuZENoaWxkKG5hbWUpXHJcblxyXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJylcclxuICBkYXRlLmlubmVySFRNTCA9IG5ldyBEYXRlKHJldmlldy51cGRhdGVkQXQpLnRvTG9jYWxlU3RyaW5nKClcclxuICBsaS5hcHBlbmRDaGlsZChkYXRlKVxyXG5cclxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJylcclxuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWBcclxuICBsaS5hcHBlbmRDaGlsZChyYXRpbmcpXHJcblxyXG4gIGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXHJcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzXHJcbiAgbGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpXHJcblxyXG4gIHJldHVybiBsaVxyXG59XHJcblxyXG4vKipcclxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcclxuICovXHJcbmxldCBmaWxsQnJlYWRjcnVtYiA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJylcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJylcclxuICBsaS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWVcclxuICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmxldCBnZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XHJcbiAgaWYgKCF1cmwpIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmXHJcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpXHJcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBbPyZdJHtuYW1lfSg9KFteJiNdKil8JnwjfCQpYCksXHJcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpXHJcbiAgaWYgKCFyZXN1bHRzKSByZXR1cm4gbnVsbFxyXG4gIGlmICghcmVzdWx0c1syXSkgcmV0dXJuICcnXHJcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKVxyXG59XHJcblxyXG4vKipcclxuICpDcmVhdGUgZm9ybSB0aWxlLlxyXG4gKi9cclxubGV0IGNyZWF0ZUZvcm0gPSAoKSA9PiB7XHJcbiAgY29uc3QgYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FydGljbGUnKVxyXG5cclxuICAvL0hlYWRlclxyXG4gIGNvbnN0IGhlYWRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpXHJcbiAgaGVhZGluZy5pbm5lckhUTUwgPSAnSGF2ZSBhbiBvcGluaW9uPydcclxuICBhcnRpY2xlLmFwcGVuZChoZWFkaW5nKVxyXG4gIGNvbnN0IHN1YmhlYWRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoNCcpXHJcbiAgc3ViaGVhZGluZy5pbm5lckhUTUwgPSAnTGV0IHVzIGtub3cgd2hhdCB5b3UgdGhpbmsuJ1xyXG4gIGFydGljbGUuYXBwZW5kKHN1YmhlYWRpbmcpXHJcblxyXG4gIC8vRm9ybVxyXG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcclxuICBmb3JtLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgJ2phdmFzY3JpcHQ6dm9pZCgwKScpXHJcbiAgZm9ybS5zZXRBdHRyaWJ1dGUoJ29uc3VibWl0JywgJ3N1Ym1pdFJldmlldygpJylcclxuXHJcbiAgLy9GaXJzdCBJbnB1dFxyXG4gIGNvbnN0IGRpdjEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG5cclxuICBjb25zdCBsYWJlbDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXHJcbiAgbGFiZWwxLmlubmVySFRNTCA9ICdZb3VyIE5hbWUnXHJcbiAgbGFiZWwxLnNldEF0dHJpYnV0ZSgnZm9yJywgJ3Jldmlld2VyTmFtZScpXHJcbiAgZGl2MS5hcHBlbmQobGFiZWwxKVxyXG5cclxuICBjb25zdCBpbnB1dDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXHJcbiAgaW5wdXQxLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0JylcclxuICBpbnB1dDEuc2V0QXR0cmlidXRlKCduYW1lJywgJ3Jldmlld2VyTmFtZScpXHJcbiAgaW5wdXQxLnNldEF0dHJpYnV0ZSgnaWQnLCAncmV2aWV3ZXJOYW1lJylcclxuICBpbnB1dDEuc2V0QXR0cmlidXRlKCdyZXF1aXJlZCcsICdyZXF1aXJlZCcpXHJcbiAgZGl2MS5hcHBlbmQoaW5wdXQxKVxyXG5cclxuICBmb3JtLmFwcGVuZChkaXYxKVxyXG5cclxuICAvL1NlY29uZCBJbnB1dFxyXG4gIGNvbnN0IGRpdjIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG5cclxuICBjb25zdCBsYWJlbDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXHJcbiAgbGFiZWwyLmlubmVySFRNTCA9ICdSYXRpbmcgKDEtNSknXHJcbiAgbGFiZWwyLnNldEF0dHJpYnV0ZSgnZm9yJywgJ25ld1Jldmlld1JhdGluZycpXHJcbiAgZGl2Mi5hcHBlbmQobGFiZWwyKVxyXG5cclxuICBjb25zdCBpbnB1dDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXHJcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgndHlwZScsICdudW1iZXInKVxyXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ21pbicsICcxJylcclxuICBpbnB1dDIuc2V0QXR0cmlidXRlKCdtYXgnLCAnNScpXHJcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgnbmFtZScsICduZXdSZXZpZXdSYXRpbmcnKVxyXG4gIGlucHV0Mi5zZXRBdHRyaWJ1dGUoJ2lkJywgJ25ld1Jldmlld1JhdGluZycpXHJcbiAgaW5wdXQyLnNldEF0dHJpYnV0ZSgncmVxdWlyZWQnLCAncmVxdWlyZWQnKVxyXG4gIGRpdjIuYXBwZW5kKGlucHV0MilcclxuXHJcbiAgZm9ybS5hcHBlbmQoZGl2MilcclxuXHJcbiAgLy9MYXN0IFVzZXIgSW5wdXRcclxuICBjb25zdCBkaXYzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuXHJcbiAgY29uc3QgbGFiZWwzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxyXG4gIGxhYmVsMy5pbm5lckhUTUwgPSAnQ29tbWVudHMnXHJcbiAgbGFiZWwzLnNldEF0dHJpYnV0ZSgnZm9yJywgJ25ld1Jldmlld0NvbW1lbnRzJylcclxuICBkaXYzLmFwcGVuZChsYWJlbDMpXHJcblxyXG4gIGNvbnN0IGlucHV0MyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJylcclxuICBpbnB1dDMuc2V0QXR0cmlidXRlKCduYW1lJywgJ25ld1Jldmlld0NvbW1lbnRzJylcclxuICBpbnB1dDMuc2V0QXR0cmlidXRlKCdpZCcsICduZXdSZXZpZXdDb21tZW50cycpXHJcbiAgaW5wdXQzLnNldEF0dHJpYnV0ZSgncm93cycsICc1JylcclxuICBpbnB1dDMuc2V0QXR0cmlidXRlKCdyZXF1aXJlZCcsICdyZXF1aXJlZCcpXHJcbiAgZGl2My5hcHBlbmQoaW5wdXQzKVxyXG5cclxuICBmb3JtLmFwcGVuZChkaXYzKVxyXG5cclxuICAvL3N1Ym1pdCBidXR0b25cclxuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxyXG4gIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnc3VibWl0JylcclxuICBidXR0b24uaW5uZXJIVE1MID0gJ1N1Ym1pdCdcclxuXHJcbiAgZm9ybS5hcHBlbmQoYnV0dG9uKVxyXG5cclxuICBhcnRpY2xlLmFwcGVuZChmb3JtKVxyXG5cclxuICByZXR1cm4gYXJ0aWNsZVxyXG59XHJcblxyXG5sZXQgdG9nZ2xlRmF2b3JpdGUgPSAoKSA9PiB7XHJcbiAgbGV0IHRoaXNTdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0YXInKVxyXG4gIGlmICh0aGlzU3Rhci5jbGFzc05hbWUuaW5kZXhPZignZmF2b3JpdGUnKSAhPT0gLTEpIHtcclxuICAgIHRoaXNTdGFyLmNsYXNzTmFtZSA9ICdzdGFyJ1xyXG4gICAgREJIZWxwZXIuc2VuZFRvZ2dsZUZhdihzZWxmLnJlc3RhdXJhbnQuaWQsICdmYWxzZScpXHJcbiAgfSBlbHNlIHtcclxuICAgIHRoaXNTdGFyLmNsYXNzTmFtZSA9ICdzdGFyIGZhdm9yaXRlJ1xyXG4gICAgREJIZWxwZXIuc2VuZFRvZ2dsZUZhdihzZWxmLnJlc3RhdXJhbnQuaWQsICd0cnVlJylcclxuICB9XHJcblxyXG59XHJcblxyXG5sZXQgc3VibWl0UmV2aWV3ID0gKCkgPT4ge1xyXG4gIGxldCBwYXJhbXMgPSB7XHJcbiAgICBpZDogc2VsZi5yZXN0YXVyYW50LnJldmlld3MubGVuZ3RoICsgMSxcclxuICAgIHJlc3RhdXJhbnRfaWQ6IHNlbGYucmVzdGF1cmFudC5pZCxcclxuICAgIG5hbWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdlck5hbWUnKS52YWx1ZSxcclxuICAgIGNyZWF0ZWRBdDogRGF0ZS5ub3coKSxcclxuICAgIHVwZGF0ZWRBdDogRGF0ZS5ub3coKSxcclxuICAgIHJhdGluZzogcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ld1Jldmlld1JhdGluZycpLnZhbHVlKSxcclxuICAgIGNvbW1lbnRzOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3UmV2aWV3Q29tbWVudHMnKS52YWx1ZVxyXG4gIH1cclxuXHJcbiAgREJIZWxwZXIuYWRkUmV2aWV3KHBhcmFtcylcclxuICBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cy5wdXNoKHBhcmFtcylcclxuICBmaWxsUmV2aWV3c0hUTUwoKVxyXG5cclxufSJdfQ==
